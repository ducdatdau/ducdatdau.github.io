<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<title>Flare-On 11 - ducdatdau</title><meta name=Description content="just a street kid with a solid academic background"><meta property="og:title" content="Flare-On 11">
<meta property="og:description" content="img {box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;border-radius: 6px;display: block; margin: 0 auto 15px;}Challenge 1: frog A game written in Python: your task is to move the frog to the correct spot to get the flag.
0x01 Getting the flag We can open the game&rsquo;s source code to read it - it&rsquo;s in the frog.py file. At a glance, there&rsquo;s a function that generates the &ldquo;flag&rdquo; called GenerateFlagText() :">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ducdatdau.github.io/2024-flareon/"><meta property="og:image" content="https://ducdatdau.github.io/logo.png"><meta property="article:section" content="ctf-writeup">
<meta property="article:published_time" content="2024-12-31T19:18:47+07:00">
<meta property="article:modified_time" content="2024-12-31T19:18:47+07:00"><meta property="og:site_name" content="ducdatdau blog">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://ducdatdau.github.io/logo.png">
<meta name=twitter:title content="Flare-On 11">
<meta name=twitter:description content="img {box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;border-radius: 6px;display: block; margin: 0 auto 15px;}Challenge 1: frog A game written in Python: your task is to move the frog to the correct spot to get the flag.
0x01 Getting the flag We can open the game&rsquo;s source code to read it - it&rsquo;s in the frog.py file. At a glance, there&rsquo;s a function that generates the &ldquo;flag&rdquo; called GenerateFlagText() :">
<meta name=application-name content="Blogs">
<meta name=apple-mobile-web-app-title content="Blogs"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://github.com/ducdatdau.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://ducdatdau.github.io/2024-flareon/><link rel=prev href=https://ducdatdau.github.io/2024-isitdtu-quals/><link rel=next href=https://ducdatdau.github.io/2025-sekai/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Flare-On 11","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ducdatdau.github.io\/2024-flareon\/"},"genre":"posts","keywords":"Reverse-Engineering, Flare-On, 2024","wordcount":3248,"url":"https:\/\/ducdatdau.github.io\/2024-flareon\/","datePublished":"2024-12-31T19:18:47+07:00","dateModified":"2024-12-31T19:18:47+07:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"ducdatdau"},"description":""}</script></head>
<body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=ducdatdau>Home</a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/misc-notes/ title="Misc Notes"> Misc Notes </a><a class=menu-item href=/research/ title=Research> Security Research </a><a class=menu-item href=/ctf-writeup/ title="CTF Writeup"> CTF </a><a class=menu-item href=/list100/ title="List 100"> List 100 </a><a class=menu-item href=/tags/> Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search>
<i class="fas fa-search fa-fw" aria-hidden=true></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear>
<i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a></div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=ducdatdau>Home</a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search>
<i class="fas fa-search fa-fw" aria-hidden=true></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear>
<i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span>
</div>
<a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
Cancel
</a>
</div><a class=menu-item href=/misc-notes/ title="Misc Notes">Misc Notes</a><a class=menu-item href=/research/ title=Research>Security Research</a><a class=menu-item href=/ctf-writeup/ title="CTF Writeup">CTF</a><a class=menu-item href=/list100/ title="List 100">List 100</a><a class=menu-item href=/tags/ title>Tags</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a></div>
</div>
</header><div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div><main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2>
<div class=toc-content id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Flare-On 11</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=https://ducdatdau.github.io/ title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>ducdatdau</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-12-31>2024-12-31</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;3248 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;16 minutes&nbsp;</div><div class=post-meta-line>
<span class=post-tags-inline style="display:inline-flex;gap:.375rem;flex-wrap:wrap;margin:.5rem 0;font-weight:500"><a class="tag-badge tag-reverse" href=/tags/reverse-engineering/ title=Reverse-Engineering><span class=tag-icon aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1 h-4 w-4"><path d="M19.439 7.85c-.049.322.059.648.289.878l1.568 1.568c.47.47.706 1.087.706 1.704s-.235 1.233-.706 1.704l-1.611 1.611a.98.98.0 01-.837.276c-.47-.07-.802-.48-.968-.925a2.501 2.501.0 10-3.214 3.214c.446.166.855.497.925.968a.979.979.0 01-.276.837l-1.61 1.61A2.404 2.404.0 0112 22.002a2.402 2.402.0 01-1.704-.706l-1.568-1.568a1.026 1.026.0 00-.877-.29c-.493.074-.84.504-1.02.968a2.5 2.5.0 11-3.237-3.237c.464-.18.894-.527.967-1.02a1.026 1.026.0 00-.289-.877l-1.568-1.568A2.402 2.402.0 011.998 12c0-.617.236-1.234.706-1.704L4.23 8.77c.24-.24.581-.353.917-.303.515.077.877.528 1.073 1.01a2.5 2.5.0 103.259-3.259c-.482-.196-.933-.558-1.01-1.073-.05-.336.062-.676.303-.917l1.525-1.525A2.402 2.402.0 0112 1.998c.617.0 1.234.236 1.704.706l1.568 1.568c.23.23.556.338.877.29.493-.074.84-.504 1.02-.968a2.5 2.5.0 113.237 3.237c-.464.18-.894.527-.967 1.02z"/></svg></span><span class=tag-text>Reverse-Engineering</span></a>
<a class="tag-badge tag-flareon" href=/tags/flare-on/ title=Flare-On><span class=tag-icon aria-hidden=true>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13,2 3,14 12,14 11,22 21,10 12,10"/></svg></span><span class=tag-text>Flare-On</span></a>
<a class="tag-badge tag-default tag-year" href=/tags/2024/ title=2024><span class=tag-text>2024</span></a>
</span>
</div></div><div class="details toc" id=toc-static data-kept>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#challenge-1-frog>Challenge 1: frog</a>
<ul>
<li><a href=#0x01-getting-the-flag>0x01 Getting the flag</a></li>
</ul>
</li>
<li><a href=#challenge-2-checksum>Challenge 2: checksum</a>
<ul>
<li><a href=#0x01-overview>0x01 Overview</a></li>
<li><a href=#0x02-static-analysis>0x02 Static Analysis</a></li>
<li><a href=#0x03-getting-the-flag>0x03 Getting the flag</a></li>
</ul>
</li>
<li><a href=#challenge-3-aray>Challenge 3: aray</a>
<ul>
<li><a href=#0x01-clean-code>0x01 Clean code</a></li>
<li><a href=#0x02-getting-the-flag>0x02 Getting the flag</a></li>
</ul>
</li>
<li><a href=#challenge-4-flare-meme-maker-3000>Challenge 4: FLARE Meme Maker 3000</a>
<ul>
<li><a href=#0x01-deobfuscate>0x01 Deobfuscate</a></li>
<li><a href=#0x02-getting-the-flag-1>0x02 Getting the flag</a></li>
</ul>
</li>
<li><a href=#challenge-5-sshd>Challenge 5: sshd</a>
<ul>
<li><a href=#0x00-my-opinion>0x00 My opinion</a></li>
<li><a href=#0x01-overview-1>0x01 Overview</a></li>
<li><a href=#0x02-analysis-the-library>0x02 Analysis the library</a></li>
<li><a href=#0x03-analysis-shellcode>0x03 Analysis shellcode</a></li>
</ul>
</li>
</ul>
</nav></div>
</div><div class=content id=content><style>img{box-shadow:rgba(0,0,0,.35)0 5px 15px;border-radius:6px;display:block;margin:0 auto 15px}</style>
<h2 id=challenge-1-frog>Challenge 1: frog</h2>
<p>A game written in Python: your task is to move the frog to the correct spot to get the flag.</p>
<img src=./22.png>
<h3 id=0x01-getting-the-flag>0x01 Getting the flag</h3>
<p>We can open the game&rsquo;s source code to read it - it&rsquo;s in the <code>frog.py</code> file. At a glance, there&rsquo;s a function that generates the &ldquo;flag&rdquo; called <code>GenerateFlagText()</code> :</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>GenerateFlagText</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
    <span class=n>key</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=o>*</span><span class=mi>20</span>
    <span class=n>encoded</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\xa5\xb7\xbe\xb1\xbd\xbf\xb7\x8d\xa6\xbd\x8d\xe3\xe3\x92\xb4\xbe\xb3\xa0\xb7\xff\xbd\xbc\xfc\xb1\xbd\xbf</span><span class=s2>&#34;</span>
    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=o>^</span> <span class=n>key</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>encoded</span><span class=p>])</span>
</code></pre></td></tr></table>
</div>
</div><p>We don&rsquo;t need the exact values of <code>x</code> and <code>y</code>. Instead, we&rsquo;ll brute-force all values from 0 to 999 to find the correct flag.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>GenerateFlagText</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
    <span class=n>key</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=o>*</span><span class=mi>20</span>
    <span class=n>encoded</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\xa5\xb7\xbe\xb1\xbd\xbf\xb7\x8d\xa6\xbd\x8d\xe3\xe3\x92\xb4\xbe\xb3\xa0\xb7\xff\xbd\xbc\xfc\xb1\xbd\xbf</span><span class=s2>&#34;</span>
    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=o>^</span> <span class=n>key</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>encoded</span><span class=p>])</span>

<span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>999</span><span class=p>):</span>
    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>999</span><span class=p>):</span> 
        <span class=n>flag</span> <span class=o>=</span> <span class=n>GenerateFlagText</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
        <span class=k>if</span> <span class=s2>&#34;flare&#34;</span> <span class=ow>in</span> <span class=n>flag</span><span class=p>:</span>
            <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
            <span class=k>break</span>

<span class=c1># welcome_to_11@flare-on.com</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=challenge-2-checksum>Challenge 2: checksum</h2>
<h3 id=0x01-overview>0x01 Overview</h3>
<p>The challenge provides us with a PE64 file written in Golang, along with several questions related to the result of a &ldquo;checksum&rdquo; calculation.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>C:\Users\PWN2OWN&gt;&#34;C:\Users\PWN2OWN\FlareOn\2024\checksum.exe&#34;
Check sum: 9418 + 92 = 9510
Good math!!!
------------------------------
Check sum: 9397 + 3991 = 13388
Good math!!!
------------------------------
Check sum: 5380 + 1695 = 7075
Good math!!!
------------------------------
Check sum: 3936 + 7655 = 11591
Good math!!!
------------------------------
Checksum: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
Maybe it&#39;s time to analyze the binary! ;)
</code></pre></td></tr></table>
</div>
</div><h3 id=0x02-static-analysis>0x02 Static Analysis</h3>
<p>The program contains three non-library functions: <code>main_main</code>, <code>main_a</code>, <code>main_b</code>.</p>
<img src=./1.png>
<p>First, <code>randomTimes</code> represents the number of math questions to be generated, with its value randomly chosen in the range [0, 5]. This value is then increased by 3, resulting in a total of 3 to 8 arithmetic questions.</p>
<p>Each question randomly generates two operators, which I renamed to <code>fsRandom</code> and <code>seRandom</code>. The player&rsquo;s task is to input the correct sum of these two numbers. If all answers are correct, the program proceeds to the next stage.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c>  <span class=n>randomTimes</span> <span class=o>=</span> <span class=n>math_rand_v2__ptr_Rand_uint64n</span><span class=p>(</span><span class=n>math_rand_v2_globalRand</span><span class=p>,</span> <span class=mi>5</span><span class=p>);</span>
  <span class=n>inputNumber</span> <span class=o>=</span> <span class=p>(</span><span class=kt>int</span> <span class=o>*</span><span class=p>)</span><span class=n>runtime_newobject</span><span class=p>(</span><span class=o>&amp;</span><span class=n>RTYPE_int</span><span class=p>);</span>
  <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>randomTimes</span> <span class=o>+</span> <span class=mi>3</span><span class=p>;</span> <span class=n>i</span> <span class=o>=</span> <span class=n>v45</span> <span class=o>+</span> <span class=mi>1</span> <span class=p>)</span>
  <span class=p>{</span>
    <span class=n>v45</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
    <span class=n>fsRandom</span> <span class=o>=</span> <span class=n>math_rand_v2__ptr_Rand_uint64n</span><span class=p>(</span><span class=n>math_rand_v2_globalRand</span><span class=p>,</span> <span class=mi>10000</span><span class=p>);</span>
    <span class=n>seRandom</span> <span class=o>=</span> <span class=n>math_rand_v2__ptr_Rand_uint64n</span><span class=p>(</span><span class=n>math_rand_v2_globalRand</span><span class=p>,</span> <span class=mi>10000</span><span class=p>);</span>
    <span class=n>v66</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=n>v67</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=n>v2</span> <span class=o>=</span> <span class=n>runtime_convT64</span><span class=p>(</span><span class=n>fsRandom</span><span class=p>);</span>
    <span class=o>*</span><span class=p>(</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v66</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>RTYPE_int</span><span class=p>;</span>
    <span class=o>*</span><span class=p>((</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v66</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>=</span> <span class=n>v2</span><span class=p>;</span>
    <span class=n>v3</span> <span class=o>=</span> <span class=n>runtime_convT64</span><span class=p>(</span><span class=n>seRandom</span><span class=p>);</span>
    <span class=o>*</span><span class=p>(</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v67</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>RTYPE_int</span><span class=p>;</span>
    <span class=o>*</span><span class=p>((</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v67</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>=</span> <span class=n>v3</span><span class=p>;</span>
    <span class=n>sumRandom</span> <span class=o>=</span> <span class=n>fsRandom</span> <span class=o>+</span> <span class=n>seRandom</span><span class=p>;</span>
    <span class=n>fmt_Fprintf</span><span class=p>(</span><span class=n>go_itab__os_File_io_Writer</span><span class=p>,</span> <span class=n>os_Stdout</span><span class=p>,</span> <span class=s>&#34;Check sum: %d + %d = &#34;</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>v66</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
    <span class=n>v65</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>RTYPE__ptr_int</span><span class=p>;</span>
    <span class=n>v65</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>inputNumber</span><span class=p>;</span>
    <span class=n>v72</span> <span class=o>=</span> <span class=n>fmt_Fscanf</span><span class=p>(</span><span class=n>go_itab__os_File_io_Reader</span><span class=p>,</span> <span class=n>os_Stdin</span><span class=p>,</span> <span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>v65</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
    <span class=n>v4</span> <span class=o>=</span> <span class=n>main_b</span><span class=p>(</span><span class=n>v72</span><span class=p>.</span><span class=n>_r1</span><span class=p>,</span> <span class=n>v72</span><span class=p>.</span><span class=n>_r2</span><span class=p>,</span> <span class=s>&#34;Not a valid answer...&#34;</span><span class=p>,</span> <span class=mi>21</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span> <span class=o>*</span><span class=p>(</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)</span><span class=n>inputNumber</span> <span class=o>!=</span> <span class=n>fsRandom</span> <span class=o>+</span> <span class=n>seRandom</span> <span class=p>)</span>
    <span class=p>{</span>
      <span class=n>runtime_printlock</span><span class=p>(</span><span class=n>v4</span><span class=p>);</span>
      <span class=n>v5</span> <span class=o>=</span> <span class=n>runtime_printstring</span><span class=p>(</span><span class=s>&#34;Try again! ;)</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=mi>14</span><span class=p>);</span>
      <span class=n>runtime_printunlock</span><span class=p>(</span><span class=n>v5</span><span class=p>);</span>
      <span class=k>return</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=p>((</span><span class=kt>void</span> <span class=p>(</span><span class=o>*</span><span class=p>)(</span><span class=kt>void</span><span class=p>))</span><span class=n>runtime_printlock</span><span class=p>)();</span>
    <span class=n>v1</span> <span class=o>=</span> <span class=n>runtime_printstring</span><span class=p>(</span><span class=s>&#34;Good math!!!</span><span class=se>\n</span><span class=s>------------------------------</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=mi>44</span><span class=p>);</span>
    <span class=n>runtime_printunlock</span><span class=p>(</span><span class=n>v1</span><span class=p>);</span>
  <span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>The program then prompts for a checksum input and verifies its validity using a Golang API.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c>  <span class=n>input_checksum</span> <span class=o>=</span> <span class=p>(</span><span class=n>string</span> <span class=o>*</span><span class=p>)</span><span class=n>runtime_newobject</span><span class=p>(</span><span class=o>&amp;</span><span class=n>RTYPE_string</span><span class=p>);</span>
  <span class=n>input_checksum</span><span class=o>-&gt;</span><span class=n>ptr</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
  <span class=n>v64</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>RTYPE_string</span><span class=p>;</span>
  <span class=n>v64</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>off_4EDAB0</span><span class=p>;</span>                         <span class=c1>// checksum
</span><span class=c1></span>  <span class=n>fmt_Fprint</span><span class=p>(</span><span class=n>go_itab__os_File_io_Writer</span><span class=p>,</span> <span class=n>os_Stdout</span><span class=p>,</span> <span class=n>v64</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
  <span class=n>v63</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>RTYPE__ptr_string</span><span class=p>;</span>
  <span class=n>v63</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>input_checksum</span><span class=p>;</span>
  <span class=n>v70</span> <span class=o>=</span> <span class=n>fmt_Fscanf</span><span class=p>(</span><span class=n>go_itab__os_File_io_Reader</span><span class=p>,</span> <span class=n>os_Stdin</span><span class=p>,</span> <span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>v63</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
  <span class=n>main_b</span><span class=p>(</span><span class=n>v70</span><span class=p>.</span><span class=n>_r1</span><span class=p>,</span> <span class=n>v70</span><span class=p>.</span><span class=n>_r2</span><span class=p>,</span> <span class=s>&#34;Fail to read checksum input...&#34;</span><span class=p>,</span> <span class=mi>30</span><span class=p>);</span>
</code></pre></td></tr></table>
</div>
</div>
<p>The <code>input_checksum</code> must be exactly 32 bytes long, where the first 24 bytes are extracted as the buffer. The program uses the XChaCha20-Poly1305 encryption algorithm, which requires a 32-byte key and a 24-byte nonce. Based on this, we can hypothesize that the buffer serves as the nonce in this encryption scheme.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c>  <span class=n>buffer</span> <span class=o>=</span> <span class=p>(</span><span class=n>BYTE</span> <span class=o>*</span><span class=p>)</span><span class=n>runtime_makeslice</span><span class=p>(</span><span class=o>&amp;</span><span class=n>RTYPE_uint8</span><span class=p>,</span> <span class=mi>24</span><span class=p>,</span> <span class=mi>24</span><span class=p>);</span>
  <span class=n>input_checksum_length</span> <span class=o>=</span> <span class=n>v44</span><span class=p>;</span>
  <span class=n>v14</span> <span class=o>=</span> <span class=n>r0</span><span class=p>;</span>
  <span class=k>for</span> <span class=p>(</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>input_checksum_length</span> <span class=o>&gt;</span> <span class=p>(</span><span class=kr>__int64</span><span class=p>)</span><span class=n>j</span> <span class=o>&amp;&amp;</span> <span class=n>j</span> <span class=o>!=</span> <span class=mi>24</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span> <span class=p>)</span>
  <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span> <span class=n>j</span> <span class=o>&gt;=</span> <span class=mh>0x18</span> <span class=p>)</span>
      <span class=k>goto</span> <span class=n>LABEL_33</span><span class=p>;</span>
    <span class=n>buffer</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>v14</span><span class=o>-&gt;</span><span class=n>key</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>                    <span class=c1>// buffer = input_checksum[0:24]
</span><span class=c1></span>  <span class=p>}</span>
  <span class=n>v59</span><span class=p>.</span><span class=n>cap</span> <span class=o>=</span> <span class=p>(</span><span class=n>size_t</span><span class=p>)</span><span class=n>buffer</span><span class=p>;</span>
  <span class=k>if</span> <span class=p>(</span> <span class=n>input_checksum_length</span> <span class=o>==</span> <span class=mi>32</span> <span class=p>)</span>            <span class=c1>// must be 32 bytes
</span><span class=c1></span>  <span class=p>{</span>
    <span class=n>p_chacha20poly1305_xchacha20poly1305</span> <span class=o>=</span> <span class=p>(</span><span class=n>chacha20poly1305_xchacha20poly1305</span> <span class=o>*</span><span class=p>)</span><span class=n>runtime_newobject</span><span class=p>(</span><span class=o>&amp;</span><span class=n>RTYPE_chacha20poly1305_xchacha20poly1305</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span> <span class=n>p_chacha20poly1305_xchacha20poly1305</span> <span class=o>!=</span> <span class=n>r0</span> <span class=p>)</span>
    <span class=p>{</span>
      <span class=n>v57</span> <span class=o>=</span> <span class=n>p_chacha20poly1305_xchacha20poly1305</span><span class=p>;</span>
      <span class=n>runtime_memmove</span><span class=p>(</span><span class=n>p_chacha20poly1305_xchacha20poly1305</span><span class=p>,</span> <span class=n>r0</span><span class=p>,</span> <span class=mi>32</span><span class=p>);</span>
      <span class=n>p_chacha20poly1305_xchacha20poly1305</span> <span class=o>=</span> <span class=n>v57</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=n>v16</span> <span class=o>=</span> <span class=n>go_itab__golang_org_x_crypto_chacha20poly1305_xchacha20poly1305_crypto_cipher_AEAD</span><span class=p>;</span>
    <span class=n>v17</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=n>v18</span> <span class=o>=</span> <span class=n>p_chacha20poly1305_xchacha20poly1305</span><span class=p>;</span>
    <span class=n>v19</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=k>else</span>
  <span class=p>{</span>
    <span class=n>v62</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>32</span><span class=p>;</span>
    <span class=n>v62</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=s>&#34;chacha20poly1305: bad key length&#34;</span><span class=p>;</span>
    <span class=n>v16</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=n>v17</span> <span class=o>=</span> <span class=n>go_itab__errors_errorString_error</span><span class=p>;</span>
    <span class=n>v18</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=n>v19</span> <span class=o>=</span> <span class=n>v62</span><span class=p>;</span>
  <span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div>
<p>By decoding the <code>encryptedFlagData</code> using the key and the nonce mentioned above, we obtain the <code>decryptedData</code>. The <code>decryptedData</code> is hashed using SHA-256, then converted to a hexadecimal string and compared with <code>input_checksum</code>.</p>
<img src=./4.png>
<p>If they match, the function <code>main_a</code> is called and the result is printed to <code>{os_UserCacheDir}\REAL_FLAREON_FLAG.JPG</code>.</p>
<img src=./5.png>
<p>Analyzing the <code>main_a</code> function, we can see that its logic is relatively straightforward. The <code>input_checksum</code> is XORed with the string <code>FlareOn2024</code>, then base64-encoded and compared with the string: <code>cQoFRQErX1YAVw1zVQdFUSxfAQNRBXUNAxBSe15QCVRVJ1pQEwd/WFBUAlElCFBFUnlaB1ULByRdBEFdfVtWVA==</code>.</p>
<img src=./6.png>
<h3 id=0x03-getting-the-flag>0x03 Getting the flag</h3>
<p>Finding correct checksum value:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=o>&gt;&gt;&gt;</span> <span class=n>x</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;cQoFRQErX1YAVw1zVQdFUSxfAQNRBXUNAxBSe15QCVRVJ1pQEwd/WFBUAlElCFBFUnlaB1ULByRdBEFdfVtWVA==&#34;</span>
<span class=o>&gt;&gt;&gt;</span> <span class=n>y</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;FlareOn2024&#34;</span>
<span class=o>&gt;&gt;&gt;</span> <span class=kn>import</span> <span class=nn>base64</span>
<span class=o>&gt;&gt;&gt;</span> <span class=n>xx</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=o>&gt;&gt;&gt;</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>xx</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)])</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>xx</span><span class=p>)))</span>
<span class=s1>&#39;7fd7dd1d0e959f74c133c13abb740b9faa61ab06bd0ecd177645e93b1e3825dd&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>Finding flag in local app data <code>C:\Users\PWN2OWN\AppData\Local</code></p>
<img src=./7.jpg>
<h2 id=challenge-3-aray>Challenge 3: aray</h2>
<p>The challenge provides a YARA rule file, and the task is to find an input that satisfies all the conditions defined in the rule.</p>
<img src=./8.png>
<h3 id=0x01-clean-code>0x01 Clean code</h3>
<p>First, clean up the code by replacing all occurrences of <code>and</code> with line breaks <code>\n</code> for better readability. At a glance, there are two types of data involved:</p>
<ul>
<li>uint8</li>
<li>unint32</li>
</ul>
<p>with operands: <code>+</code>, <code>-</code>, <code>&</code>, <code>%</code>.</p>
<p>Additionally, there are several comparisons using hash functions like <code>sha256</code>, <code>md5</code>, and <code>crc32</code> such as:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>hash.crc32(8, 2) == 0x61089c5c 
hash.crc32(34, 2) == 0x5888fc1b 
hash.crc32(63, 2) == 0x66715919 
hash.sha256(14, 2) == &#34;403d5f23d149670348b147a15eeb7010914701a7e99aad2e43f90cfa0325c76f&#34;
hash.sha256(56, 2) == &#34;593f2d04aab251f60c9e4b8bbc1e05a34e920980ec08351a18459b2bc7dbf2f6&#34;
hash.md5(0, 2) == &#34;89484b14b36a8d5329426a3d944d2983&#34;
hash.crc32(78, 2) == 0x7cab8d64 
hash.md5(76, 2) == &#34;f98ed07a4d5f50f7de1410d905f1477f&#34;
hash.md5(50, 2) == &#34;657dae0913ee12be6fb2a6f687aae1c7&#34;
hash.md5(32, 2) == &#34;738a656e8e8ec272ca17cd51e12f558b&#34;
</code></pre></td></tr></table>
</div>
</div><p>With each chunk being only 2 bytes, it&rsquo;s easy to brute-force to find values that satisfy these conditions.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=c1># Define all hash targets and positions</span>
<span class=n>targets</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>(</span><span class=s1>&#39;crc32&#39;</span><span class=p>,</span>   <span class=mi>8</span><span class=p>,</span>  <span class=mh>0x61089c5c</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;crc32&#39;</span><span class=p>,</span>   <span class=mi>34</span><span class=p>,</span> <span class=mh>0x5888fc1b</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;crc32&#39;</span><span class=p>,</span>   <span class=mi>63</span><span class=p>,</span> <span class=mh>0x66715919</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;sha256&#39;</span><span class=p>,</span>  <span class=mi>14</span><span class=p>,</span> <span class=s2>&#34;403d5f23d149670348b147a15eeb7010914701a7e99aad2e43f90cfa0325c76f&#34;</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;sha256&#39;</span><span class=p>,</span>  <span class=mi>56</span><span class=p>,</span> <span class=s2>&#34;593f2d04aab251f60c9e4b8bbc1e05a34e920980ec08351a18459b2bc7dbf2f6&#34;</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;md5&#39;</span><span class=p>,</span>     <span class=mi>0</span><span class=p>,</span>  <span class=s2>&#34;89484b14b36a8d5329426a3d944d2983&#34;</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;crc32&#39;</span><span class=p>,</span>   <span class=mi>78</span><span class=p>,</span> <span class=mh>0x7cab8d64</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;md5&#39;</span><span class=p>,</span>     <span class=mi>76</span><span class=p>,</span> <span class=s2>&#34;f98ed07a4d5f50f7de1410d905f1477f&#34;</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;md5&#39;</span><span class=p>,</span>     <span class=mi>50</span><span class=p>,</span> <span class=s2>&#34;657dae0913ee12be6fb2a6f687aae1c7&#34;</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;md5&#39;</span><span class=p>,</span>     <span class=mi>32</span><span class=p>,</span> <span class=s2>&#34;738a656e8e8ec272ca17cd51e12f558b&#34;</span><span class=p>),</span>
<span class=p>]</span>

<span class=c1># Choose charset (printable ASCII)</span>
<span class=n>charset</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=mi>127</span><span class=p>)</span>

<span class=c1># Brute-force</span>
<span class=k>for</span> <span class=n>hash_type</span><span class=p>,</span> <span class=n>offset</span><span class=p>,</span> <span class=n>expected</span> <span class=ow>in</span> <span class=n>targets</span><span class=p>:</span>
    <span class=c1># print(f&#34;[*] Brute-forcing {hash_type} at offset {offset}...&#34;)</span>

    <span class=n>found</span> <span class=o>=</span> <span class=kc>False</span>
    <span class=k>for</span> <span class=n>c1</span><span class=p>,</span> <span class=n>c2</span> <span class=ow>in</span> <span class=n>itertools</span><span class=o>.</span><span class=n>product</span><span class=p>(</span><span class=n>charset</span><span class=p>,</span> <span class=n>repeat</span><span class=o>=</span><span class=mi>2</span><span class=p>):</span>
        <span class=n>pair</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>([</span><span class=n>c1</span><span class=p>,</span> <span class=n>c2</span><span class=p>])</span>

        <span class=k>if</span> <span class=n>hash_type</span> <span class=o>==</span> <span class=s1>&#39;crc32&#39;</span><span class=p>:</span>
            <span class=n>h</span> <span class=o>=</span> <span class=n>binascii</span><span class=o>.</span><span class=n>crc32</span><span class=p>(</span><span class=n>pair</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xffffffff</span>
            <span class=k>if</span> <span class=n>h</span> <span class=o>==</span> <span class=n>expected</span><span class=p>:</span>
                <span class=n>found</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=k>elif</span> <span class=n>hash_type</span> <span class=o>==</span> <span class=s1>&#39;sha256&#39;</span><span class=p>:</span>
            <span class=n>h</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>pair</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
            <span class=k>if</span> <span class=n>h</span> <span class=o>==</span> <span class=n>expected</span><span class=p>:</span>
                <span class=n>found</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=k>elif</span> <span class=n>hash_type</span> <span class=o>==</span> <span class=s1>&#39;md5&#39;</span><span class=p>:</span>
            <span class=n>h</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>(</span><span class=n>pair</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
            <span class=k>if</span> <span class=n>h</span> <span class=o>==</span> <span class=n>expected</span><span class=p>:</span>
                <span class=n>found</span> <span class=o>=</span> <span class=kc>True</span>

        <span class=k>if</span> <span class=n>found</span><span class=p>:</span>
            <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>flag</span><span class=p>[</span><span class=n>offset</span><span class=p>]</span> <span class=o>==</span> <span class=n>c1</span><span class=p>)</span>
            <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>flag</span><span class=p>[</span><span class=n>offset</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=n>c2</span><span class=p>)</span>
            <span class=k>break</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>found</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[-] No match found at offset </span><span class=si>{</span><span class=n>offset</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>For the remaining conditions, we can easily solve them using Z3.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>z3</span> <span class=kn>import</span> <span class=o>*</span> 

<span class=n>filesize</span> <span class=o>=</span> <span class=mi>85</span>
<span class=n>flag</span> <span class=o>=</span> <span class=p>[</span><span class=n>BitVec</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;b</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=mi>85</span> <span class=o>*</span> <span class=mi>8</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>filesize</span><span class=p>)]</span>

<span class=n>s</span> <span class=o>=</span> <span class=n>Solver</span><span class=p>()</span>

<span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>((</span><span class=n>filesize</span> <span class=o>^</span> <span class=n>flag</span><span class=p>[</span><span class=mi>11</span><span class=p>])</span> <span class=o>!=</span> <span class=mi>107</span> <span class=p>)</span>
<span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>((</span><span class=n>flag</span><span class=p>[</span><span class=mi>55</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mi>128</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>)</span>
<span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>((</span><span class=n>flag</span><span class=p>[</span><span class=mi>58</span><span class=p>])</span> <span class=o>+</span> <span class=mi>25</span> <span class=o>==</span> <span class=mi>122</span> <span class=p>)</span>
<span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>((</span><span class=n>flag</span><span class=p>[</span><span class=mi>7</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mi>128</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>)</span>
<span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>((</span><span class=n>flag</span><span class=p>[</span><span class=mi>48</span><span class=p>])</span> <span class=o>%</span> <span class=mi>12</span> <span class=o>&lt;</span> <span class=mi>12</span> <span class=p>)</span>

<span class=p>[</span><span class=o>...</span><span class=p>]</span>

<span class=k>if</span> <span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>check</span><span class=p>()</span> <span class=o>==</span> <span class=n>sat</span><span class=p>):</span>
    <span class=n>res</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>flag</span><span class=p>:</span>
        <span class=n>res</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>model</span><span class=p>()[</span><span class=n>b</span><span class=p>]</span><span class=o>.</span><span class=n>as_long</span><span class=p>())</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=0x02-getting-the-flag>0x02 Getting the flag</h3>
<p><a href=./solve.py rel>Full script</a></p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell>C:<span class=se>\U</span>sers<span class=se>\P</span>WN2OWN<span class=se>\C</span>TF<span class=se>\F</span>lare-On<span class=se>\F</span>lare11<span class=se>\3</span>_aray<span class=se>\a</span>ray&gt;python solve.py
bytearray<span class=o>(</span>b<span class=s1>&#39;rule flareon { strings: $f = &#34;1RuleADayK33p$Malw4r3Aw4y@flare-on.com&#34; condition: $f }&#39;</span><span class=o>)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=challenge-4-flare-meme-maker-3000>Challenge 4: FLARE Meme Maker 3000</h2>
<p>The challenge provides a <code>mememaker3000.html</code> file containing an obfuscated JavaScript snippet.</p>
<img src=./9.png>
<h3 id=0x01-deobfuscate>0x01 Deobfuscate</h3>
<p>Deobfuscate using the website <a href=https://deobfuscate.relative.im target=_blank rel="noopener noreffer">https://deobfuscate.relative.im</a>, the resulting source code is quite clear:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=kr>const</span> <span class=nx>a0c</span> <span class=o>=</span> <span class=p>[</span>
    <span class=s1>&#39;When you find a buffer overflow in legacy code&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Reverse Engineer&#39;</span><span class=p>,</span>
    <span class=s1>&#39;When you decompile the obfuscated code and it makes perfect sense&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Me after a week of reverse engineering&#39;</span><span class=p>,</span>
    <span class=s1>&#39;When your decompiler crashes&#39;</span><span class=p>,</span>
    <span class=s2>&#34;It&#39;s not a bug, it&#39;a a feature&#34;</span><span class=p>,</span>
    <span class=s2>&#34;Security &#39;Expert&#39;&#34;</span><span class=p>,</span>
    <span class=s1>&#39;AI&#39;</span><span class=p>,</span>
    <span class=s2>&#34;That&#39;s great, but can you hack it?&#34;</span><span class=p>,</span>
    <span class=s1>&#39;When your code compiles for the first time&#39;</span><span class=p>,</span>
    <span class=s2>&#34;If it ain&#39;t broke, break it&#34;</span><span class=p>,</span>
    <span class=s2>&#34;Reading someone else&#39;s code&#34;</span><span class=p>,</span>
    <span class=s1>&#39;EDR&#39;</span><span class=p>,</span>
    <span class=s1>&#39;This is fine&#39;</span><span class=p>,</span>
    <span class=s1>&#39;FLARE On&#39;</span><span class=p>,</span>
    <span class=s2>&#34;It&#39;s always DNS&#34;</span><span class=p>,</span>
    <span class=s1>&#39;strings.exe&#39;</span><span class=p>,</span>
    <span class=s2>&#34;Don&#39;t click on that.&#34;</span><span class=p>,</span>
    <span class=s1>&#39;When you find the perfect 0-day exploit&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Security through obscurity&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Instant Coffee&#39;</span><span class=p>,</span>
    <span class=s1>&#39;H@x0r&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Malware&#39;</span><span class=p>,</span>
    <span class=s1>&#39;$1,000,000&#39;</span><span class=p>,</span>
    <span class=s1>&#39;IDA Pro&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Security Expert&#39;</span><span class=p>,</span>
  <span class=p>],</span>
  <span class=nx>a0d</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>doge1</span><span class=o>:</span> <span class=p>[</span>
      <span class=p>[</span><span class=s1>&#39;75%&#39;</span><span class=p>,</span> <span class=s1>&#39;25%&#39;</span><span class=p>],</span>
      <span class=p>[</span><span class=s1>&#39;75%&#39;</span><span class=p>,</span> <span class=s1>&#39;82%&#39;</span><span class=p>],</span>
    <span class=p>],</span>
    <span class=nx>boy_friend0</span><span class=o>:</span> <span class=p>[</span>
      <span class=p>[</span><span class=s1>&#39;75%&#39;</span><span class=p>,</span> <span class=s1>&#39;25%&#39;</span><span class=p>],</span>
      <span class=p>[</span><span class=s1>&#39;40%&#39;</span><span class=p>,</span> <span class=s1>&#39;60%&#39;</span><span class=p>],</span>
      <span class=p>[</span><span class=s1>&#39;70%&#39;</span><span class=p>,</span> <span class=s1>&#39;70%&#39;</span><span class=p>],</span>
    <span class=p>],</span>
    <span class=nx>draw</span><span class=o>:</span> <span class=p>[[</span><span class=s1>&#39;30%&#39;</span><span class=p>,</span> <span class=s1>&#39;30%&#39;</span><span class=p>]],</span>
    <span class=nx>drake</span><span class=o>:</span> <span class=p>[</span>
      <span class=p>[</span><span class=s1>&#39;10%&#39;</span><span class=p>,</span> <span class=s1>&#39;75%&#39;</span><span class=p>],</span>
      <span class=p>[</span><span class=s1>&#39;55%&#39;</span><span class=p>,</span> <span class=s1>&#39;75%&#39;</span><span class=p>],</span>
    <span class=p>],</span>
    <span class=nx>two_buttons</span><span class=o>:</span> <span class=p>[</span>
      <span class=p>[</span><span class=s1>&#39;10%&#39;</span><span class=p>,</span> <span class=s1>&#39;15%&#39;</span><span class=p>],</span>
      <span class=p>[</span><span class=s1>&#39;2%&#39;</span><span class=p>,</span> <span class=s1>&#39;60%&#39;</span><span class=p>],</span>
    <span class=p>],</span>
    <span class=nx>success</span><span class=o>:</span> <span class=p>[[</span><span class=s1>&#39;75%&#39;</span><span class=p>,</span> <span class=s1>&#39;50%&#39;</span><span class=p>]],</span>
    <span class=nx>disaster</span><span class=o>:</span> <span class=p>[[</span><span class=s1>&#39;5%&#39;</span><span class=p>,</span> <span class=s1>&#39;50%&#39;</span><span class=p>]],</span>
    <span class=nx>aliens</span><span class=o>:</span> <span class=p>[[</span><span class=s1>&#39;5%&#39;</span><span class=p>,</span> <span class=s1>&#39;50%&#39;</span><span class=p>]],</span>
  <span class=p>},</span>
  <span class=nx>a0e</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;doge1.png&#39;</span><span class=o>:</span>
      <span class=s1>&#39;data:image/png;base64, [...]&#39;</span><span class=p>,</span>
    <span class=s1>&#39;draw.jpg&#39;</span><span class=o>:</span>
      <span class=s1>&#39;data:image/jpeg;base64, [...]&#39;</span><span class=p>,</span>
    <span class=s1>&#39;drake.jpg&#39;</span><span class=o>:</span>
      <span class=s1>&#39;data:image/jpeg;base64, [...]&#39;</span><span class=p>,</span>
    <span class=s1>&#39;two_buttons.jpg&#39;</span><span class=o>:</span>
      <span class=s1>&#39;data:image/jpeg;base64, [...]&#39;</span><span class=p>,</span>
    <span class=s1>&#39;fish.jpg&#39;</span><span class=o>:</span>
    <span class=s1>&#39;data:binary/red;base64, [...]&#39;</span><span class=p>,</span>
    <span class=s1>&#39;boy_friend0.jpg&#39;</span><span class=o>:</span>
      <span class=s1>&#39;data:image/jpeg;base64, [...]&#39;</span><span class=p>,</span>
    <span class=s1>&#39;success.jpg&#39;</span><span class=o>:</span>
      <span class=s1>&#39;data:image/jpeg;base64, [...]&#39;</span><span class=p>,</span>
    <span class=s1>&#39;disaster.jpg&#39;</span><span class=o>:</span>
      <span class=s1>&#39;data:image/jpeg;base64, [...]&#39;</span><span class=p>,</span>
    <span class=s1>&#39;aliens.jpg&#39;</span><span class=o>:</span>
      <span class=s1>&#39;data:image/jpeg;base64, [...]&#39;</span><span class=p>,</span>
  <span class=p>}</span>
<span class=kd>function</span> <span class=nx>a0f</span><span class=p>()</span> <span class=p>{</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption1&#39;</span><span class=p>).</span><span class=nx>hidden</span> <span class=o>=</span> <span class=kc>true</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption2&#39;</span><span class=p>).</span><span class=nx>hidden</span> <span class=o>=</span> <span class=kc>true</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption3&#39;</span><span class=p>).</span><span class=nx>hidden</span> <span class=o>=</span> <span class=kc>true</span>
  <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;meme-template&#39;</span><span class=p>)</span>
  <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
  <span class=nx>a0d</span><span class=p>[</span><span class=nx>b</span><span class=p>].</span><span class=nx>forEach</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>var</span> <span class=nx>e</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption&#39;</span> <span class=o>+</span> <span class=p>(</span><span class=nx>d</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>
    <span class=nx>e</span><span class=p>.</span><span class=nx>hidden</span> <span class=o>=</span> <span class=kc>false</span>
    <span class=nx>e</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>top</span> <span class=o>=</span> <span class=nx>a0d</span><span class=p>[</span><span class=nx>b</span><span class=p>][</span><span class=nx>d</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
    <span class=nx>e</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>left</span> <span class=o>=</span> <span class=nx>a0d</span><span class=p>[</span><span class=nx>b</span><span class=p>][</span><span class=nx>d</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
    <span class=nx>e</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>a0c</span><span class=p>[</span><span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=p>(</span><span class=nx>a0c</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))]</span>
  <span class=p>})</span>
<span class=p>}</span>
<span class=nx>a0f</span><span class=p>()</span>
<span class=kr>const</span> <span class=nx>a0g</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;meme-image&#39;</span><span class=p>),</span>
  <span class=nx>a0h</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;meme-container&#39;</span><span class=p>),</span>
  <span class=nx>a0i</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;remake&#39;</span><span class=p>),</span>
  <span class=nx>a0j</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;meme-template&#39;</span><span class=p>)</span>
<span class=nx>a0g</span><span class=p>.</span><span class=nx>src</span> <span class=o>=</span> <span class=nx>a0e</span><span class=p>[</span><span class=nx>a0j</span><span class=p>.</span><span class=nx>value</span><span class=p>]</span>
<span class=nx>a0j</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;change&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=nx>a0g</span><span class=p>.</span><span class=nx>src</span> <span class=o>=</span> <span class=nx>a0e</span><span class=p>[</span><span class=nx>a0j</span><span class=p>.</span><span class=nx>value</span><span class=p>]</span>
  <span class=nx>a0g</span><span class=p>.</span><span class=nx>alt</span> <span class=o>=</span> <span class=nx>a0j</span><span class=p>.</span><span class=nx>value</span>
  <span class=nx>a0f</span><span class=p>()</span>
<span class=p>})</span>
<span class=nx>a0i</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=nx>a0f</span><span class=p>()</span>
<span class=p>})</span>
<span class=kd>function</span> <span class=nx>a0k</span><span class=p>()</span> <span class=p>{</span>
  <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>a0g</span><span class=p>.</span><span class=nx>alt</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>).</span><span class=nx>pop</span><span class=p>()</span>
  <span class=k>if</span> <span class=p>(</span><span class=nx>a</span> <span class=o>!==</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=nx>a0e</span><span class=p>)[</span><span class=mi>5</span><span class=p>])</span> <span class=p>{</span>
    <span class=k>return</span>
  <span class=p>}</span>
  <span class=kr>const</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>a0l</span><span class=p>.</span><span class=nx>textContent</span><span class=p>,</span>
    <span class=nx>c</span> <span class=o>=</span> <span class=nx>a0m</span><span class=p>.</span><span class=nx>textContent</span><span class=p>,</span>
    <span class=nx>d</span> <span class=o>=</span> <span class=nx>a0n</span><span class=p>.</span><span class=nx>textContent</span>
  <span class=k>if</span> <span class=p>(</span>
    <span class=nx>a0c</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span> <span class=o>==</span> <span class=mi>14</span> <span class=o>&amp;&amp;</span>
    <span class=nx>a0c</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span> <span class=o>==</span> <span class=nx>a0c</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span>
    <span class=nx>a0c</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>d</span><span class=p>)</span> <span class=o>==</span> <span class=mi>22</span>
  <span class=p>)</span> <span class=p>{</span>
    <span class=kd>var</span> <span class=nx>e</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Date</span><span class=p>().</span><span class=nx>getTime</span><span class=p>()</span>
    <span class=k>while</span> <span class=p>(</span><span class=k>new</span> <span class=nb>Date</span><span class=p>().</span><span class=nx>getTime</span><span class=p>()</span> <span class=o>&lt;</span> <span class=nx>e</span> <span class=o>+</span> <span class=mi>3000</span><span class=p>)</span> <span class=p>{}</span>
    <span class=kd>var</span> <span class=nx>f</span> <span class=o>=</span> <span class=nx>d</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;h&#39;</span> <span class=o>+</span> <span class=nx>a</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>+</span> <span class=nx>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=nx>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=nx>c</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=nx>c</span><span class=p>[</span><span class=nx>c</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;5&#39;</span> <span class=o>+</span> <span class=nx>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;4&#39;</span> <span class=o>+</span> <span class=nx>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=nx>c</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=nx>c</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=nx>c</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;3&#39;</span> <span class=o>+</span> <span class=nx>d</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=nx>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;j4&#39;</span> <span class=o>+</span> <span class=nx>a0c</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=nx>d</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;5&#39;</span> <span class=o>+</span> <span class=nx>c</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=nx>d</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;1&#39;</span> <span class=o>+</span> <span class=nx>c</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;7&#39;</span> <span class=o>+</span> <span class=nx>a0c</span><span class=p>[</span><span class=mi>21</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=nx>b</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span> <span class=s1>&#39;-&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=nx>a</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>+</span> <span class=nx>a0c</span><span class=p>[</span><span class=mi>4</span><span class=p>].</span><span class=nx>substring</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>15</span><span class=p>)</span>
    <span class=nx>f</span> <span class=o>=</span> <span class=nx>f</span><span class=p>.</span><span class=nx>toLowerCase</span><span class=p>()</span>
    <span class=nx>alert</span><span class=p>(</span><span class=nx>atob</span><span class=p>(</span><span class=s1>&#39;Q29uZ3JhdHVsYXRpb25zISBIZXJlIHlvdSBnbzog&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=nx>f</span><span class=p>)</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=kr>const</span> <span class=nx>a0l</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption1&#39;</span><span class=p>),</span>
  <span class=nx>a0m</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption2&#39;</span><span class=p>),</span>
  <span class=nx>a0n</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption3&#39;</span><span class=p>)</span>
<span class=nx>a0l</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;keyup&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=nx>a0k</span><span class=p>()</span>
<span class=p>})</span>
<span class=nx>a0m</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;keyup&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=nx>a0k</span><span class=p>()</span>
<span class=p>})</span>
<span class=nx>a0n</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;keyup&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=nx>a0k</span><span class=p>()</span>
<span class=p>})</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=0x02-getting-the-flag-1>0x02 Getting the flag</h3>
<p>There is a base64 encoded string with the content <code>Congratulations! Here you go: </code>. From this, we can deduce that the <code>a0k()</code> function contains the flag. There are 2 conditions that need to be bypassed:</p>
<p>First, the meme template must satisfy:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=k>if</span> <span class=p>(</span><span class=nx>a</span> <span class=o>!==</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=nx>a0e</span><span class=p>)[</span><span class=mi>5</span><span class=p>])</span> <span class=p>{</span>
    <span class=k>return</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>Second, the text in the boxes must satisfy:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=k>if</span> <span class=p>(</span>
    <span class=nx>a0c</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span> <span class=o>==</span> <span class=mi>14</span> <span class=o>&amp;&amp;</span>
    <span class=nx>a0c</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span> <span class=o>==</span> <span class=nx>a0c</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span>
    <span class=nx>a0c</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>d</span><span class=p>)</span> <span class=o>==</span> <span class=mi>22</span>
<span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>To satisfy the first condition, we just need to declare:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=nx>a</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=nx>a0e</span><span class=p>)[</span><span class=mi>5</span><span class=p>]</span>
</code></pre></td></tr></table>
</div>
</div><p>For the second condition, we just need to change the values of the elements right after randomization:</p>
<img src=./10.png>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=kd>function</span> <span class=nx>a0f</span><span class=p>()</span> <span class=p>{</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption1&#39;</span><span class=p>).</span><span class=nx>hidden</span> <span class=o>=</span> <span class=kc>true</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption2&#39;</span><span class=p>).</span><span class=nx>hidden</span> <span class=o>=</span> <span class=kc>true</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption3&#39;</span><span class=p>).</span><span class=nx>hidden</span> <span class=o>=</span> <span class=kc>true</span>
  <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;meme-template&#39;</span><span class=p>)</span>
  <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
  <span class=nx>a0d</span><span class=p>[</span><span class=nx>b</span><span class=p>].</span><span class=nx>forEach</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>var</span> <span class=nx>e</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption&#39;</span> <span class=o>+</span> <span class=p>(</span><span class=nx>d</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>
    <span class=nx>e</span><span class=p>.</span><span class=nx>hidden</span> <span class=o>=</span> <span class=kc>false</span>
    <span class=nx>e</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>top</span> <span class=o>=</span> <span class=nx>a0d</span><span class=p>[</span><span class=nx>b</span><span class=p>][</span><span class=nx>d</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
    <span class=nx>e</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>left</span> <span class=o>=</span> <span class=nx>a0d</span><span class=p>[</span><span class=nx>b</span><span class=p>][</span><span class=nx>d</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
    <span class=nx>e</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>a0c</span><span class=p>[</span><span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=p>(</span><span class=nx>a0c</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))]</span>
  <span class=p>})</span>
  
  <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption1&#39;</span><span class=p>).</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;FLARE On&#39;</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption2&#39;</span><span class=p>).</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;Security Expert&#39;</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;caption3&#39;</span><span class=p>).</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;Malware&#39;</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>After reloading the page, we get the flag: <code>wh0a_it5_4_cru3l_j4va5cr1p7@flare-on.com</code>.</p>
<img src=./11.png>
<h2 id=challenge-5-sshd>Challenge 5: sshd</h2>
<div class="details admonition note open">
<div class="details-summary admonition-title">
<i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i>
</div>
<div class=details-content>
<div class=admonition-content><ul>
<li><strong>Given file:</strong> <a href="https://wru-my.sharepoint.com/:u:/g/personal/2251272678_e_tlu_edu_vn/EYCYJYqV0dZCtAzhZT2O2skBMNpPgWPQ45qrW9Ztf5KQ5A?e=X5v81N" target=_blank rel="noopener noreffer">sshd.7z</a></li>
<li><strong>Description:</strong> Our server in the FLARE Intergalactic HQ has crashed! Now criminals are trying to sell me my own data!!! Do your part, random internet hacker, to help FLARE out and tell us what data they stole! We used the best forensic preservation technique of just copying all the files on the system for you.<br>
7zip archive password: flare</li>
</ul>
</div>
</div>
</div>
<h3 id=0x00-my-opinion>0x00 My opinion</h3>
<p>In my opinion, this is one of the best challenges in the series. It is related to cases of real-world cybersecurity incidents and mentions a very interesting backdoor <a href=https://en.wikipedia.org/wiki/XZ_Utils_backdoor target=_blank rel="noopener noreffer">that was discovered last year</a>.</p>
<h3 id=0x01-overview-1>0x01 Overview</h3>
<p>The challenge provides a filesystem image.</p>
<img src=./12.png>
<p>The description mentions that the server crashed due to something. When an application crashes on Linux, the coredump file is stored at <code>/var/lib/systemd/coredump</code>. There is a coredump file related to the <code>sshd</code> process.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell> ls ./var/lib/systemd/coredump
sshd.core.93794.0.0.11.1725917676
</code></pre></td></tr></table>
</div>
</div><p>To get a clearer picture of the memory at the time the process crashed, I used GDB for analysis.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell> gdb ./usr/sbin/sshd ./var/lib/systemd/coredump/sshd.core.93794.0.0.11.1725917676
</code></pre></td></tr></table>
</div>
</div><p>Looking at the information provided by the <code>bt</code> command, the program crashed due to calling a function at address <code>0x0000000000000000</code>. The function that caused the crash is at address <code>0x00007f4a18c8f88f</code>, located in the <code>liblzma.so.5</code> library.</p>
<img src=./13.png>
<p>Observing the memory mapping information using the <code>info proc mappings</code> command, we see that starting from address <code>0x7f4a18c86000</code>, there are memory regions that have been deleted but contain the faulty code at <code>0x00007f4a18c8f88f</code>.</p>
<img src=./14.png>
<p>Update the base address of the library in IDA PRO to facilitate analysis of the liblzma.so.5 library.</p>
<img src=./15.png width=400rem>
<h3 id=0x02-analysis-the-library>0x02 Analysis the library</h3>
<p>Jumping to the address that caused the crash, the function that caused the error is <code>sub_7F4A18C8F820</code>, with the content renamed as follows:</p>
<img src=./16.png>
<p>Normally, <code>dlsym</code> would call the <code>RSA_public_decrypt</code> function by its exact name. However, <code>symbol_name</code> has an extra space at the end. Therefore, <code>dlsym</code> returns NULL, and the code below causes a crash.</p>
<p>What we need to pay attention to is the code at <code>line[20:26]</code>. Thanks to the string <code>expand 32-byte k</code>, we can determine that the encryption algorithm is likely ChaCha20 or Salsa20. Its operation flow can be summarized as follows:</p>
<p>The process involves mapping and copying the encrypted shellcode into a memory region with full RWX permissions. After that, the shellcode is decrypted, executed, and then re-encrypted to avoid detection.</p>
<hr>
<p>The next task is to decrypt the shellcode.</p>
<p>There are several ways to decrypt the shellcode. You can dump the <code>init_chacha20_block, sus_crypto_fn</code>, <code>from</code>, and <code>encrypted_shellcode</code> functions and use Unicorn or Ghidra + plugin to emulate and analyze.</p>
<p>I choose a different way to save time, though it may be more error-prone. Find the <code>key</code> and <code>nonce</code> and manually decrypt the shellcode.</p>
<p>The <code>v10</code> function  the one that caused the crash calls the <code>from</code> variable as its second parameter. Therefore, <code>rsi</code> will store the value of the <code>from</code> variable</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=p>(</span><span class=n>v10</span><span class=p>)(</span><span class=n>flen</span><span class=p>,</span> <span class=n>from</span><span class=p>,</span> <span class=n>to</span><span class=p>,</span> <span class=n>rsa</span><span class=p>,</span> <span class=n>padding</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>From there, it&rsquo;s easy to determine: <code>key = from + 4</code> and <code>nonce = from + 0x24</code> based on the call to <code>init_chacha20_block_sub_7F4A18C8F3F0(v14, (from + 4), (from + 0x24), 0LL)</code>.</p>
<img src=./17.png>
<p>We see that <code>rsi = from = 0xc5407a48</code>, which matches the backdoor signature check. Continue to decrypt the shellcode with the key and nonce just found.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>ChaCha20</span> 

<span class=n>key</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x94\x3d\xf6\x38\xa8\x18\x13\xe2\xde\x63\x18\xa5\x07\xf9\xa0\xba\x2d\xbb\x8a\x7b\xa6\x36\x66\xd0\x8d\x11\xa6\x5e\xc9\x14\xd6\x6f</span><span class=s2>&#34;</span>
<span class=n>nonce</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xf2\x36\x83\x9f\x4d\xcd\x71\x1a\x52\x86\x29\x55</span><span class=s2>&#34;</span>

<span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;./dumped_bytes.bin&#34;</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span> 
    <span class=n>encrypted_data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span> 

<span class=n>cipher</span> <span class=o>=</span> <span class=n>ChaCha20</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=n>key</span><span class=p>,</span> <span class=n>nonce</span><span class=o>=</span><span class=n>nonce</span><span class=p>)</span>
<span class=n>decrypted_data</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>encrypted_data</span><span class=p>)</span>

<span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;decrypted_shellcode.bin&#34;</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>decrypted_data</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=0x03-analysis-shellcode>0x03 Analysis shellcode</h3>
<p>The shellcode is quite short and straightforward. It frequently sets the value of the <code>rax</code> register to call syscalls in the form <code>{push value; pop rax}</code></p>
<img src=./18.png>
<p>To summarize, the shellcode&rsquo;s operation flow is as follows:</p>
<ul>
<li>Create a socket and connect to <code>10.0.2.15:1337</code></li>
<li>Receive 0x20 bytes <code>key</code></li>
<li>Receive 12 bytes <code>nonce</code></li>
<li>Receive 4 bytes <code>size_of_file_path_name</code></li>
<li>Receive <code>size_of_file_path_name</code> bytes <code>file_path</code></li>
<li>Open the file</li>
<li>Read 0x80 bytes from <code>file_path</code>, store in <code>file_content</code></li>
<li>Initialize ChaCha20/Salsa algorithm</li>
<li>Encrypt file_content using the above algorithm</li>
<li>Send <code>encrypted_file_content_size</code> to C2</li>
<li>Send <code>encrypted_file_content</code> to C2</li>
<li>Close the file</li>
<li>Shutdown the connection</li>
</ul>
<p>Searching for strings in the coredump file, we find a very important path <code>/root/certificate_authority_signing_key.txt</code>. Opening HxD, we can easily see that the values around the path match the operation flow summarized above.</p>
<img src=./20.png>
<ul>
<li>Green underline: <code>key</code></li>
<li>Orange underline: <code>nonce</code></li>
<li>Red underline: <code>size_of_file_path_name</code></li>
</ul>
<p>Using IDA PRO, we calculate the offset of <code>path_name</code> relative to <code>file_content</code>.</p>
<img src=./19.png width=400>
<p>Returning to decrypting the data, the shellcode used the ChaCha20 algorithm but with a custom sigma <code>expand 32-byte K</code>.</p>
<img src=./21.png>
<p>Rewrite the entire ChaCha20 decryption function instead of using the library, and we get the challenge flag.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>struct</span>

<span class=k>def</span> <span class=nf>rotate</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>c</span><span class=p>):</span>
    <span class=k>return</span> <span class=p>((</span><span class=n>v</span> <span class=o>&lt;&lt;</span> <span class=n>c</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xffffffff</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>v</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=mi>32</span> <span class=o>-</span> <span class=n>c</span><span class=p>))</span>

<span class=k>def</span> <span class=nf>quarter_round</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>):</span>
    <span class=n>x</span><span class=p>[</span><span class=n>a</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>a</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>b</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xffffffff</span>
    <span class=n>x</span><span class=p>[</span><span class=n>d</span><span class=p>]</span> <span class=o>^=</span> <span class=n>x</span><span class=p>[</span><span class=n>a</span><span class=p>]</span>
    <span class=n>x</span><span class=p>[</span><span class=n>d</span><span class=p>]</span> <span class=o>=</span> <span class=n>rotate</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>d</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span>

    <span class=n>x</span><span class=p>[</span><span class=n>c</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>c</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>d</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xffffffff</span>
    <span class=n>x</span><span class=p>[</span><span class=n>b</span><span class=p>]</span> <span class=o>^=</span> <span class=n>x</span><span class=p>[</span><span class=n>c</span><span class=p>]</span>
    <span class=n>x</span><span class=p>[</span><span class=n>b</span><span class=p>]</span> <span class=o>=</span> <span class=n>rotate</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>b</span><span class=p>],</span> <span class=mi>12</span><span class=p>)</span>

    <span class=n>x</span><span class=p>[</span><span class=n>a</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>a</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>b</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xffffffff</span>
    <span class=n>x</span><span class=p>[</span><span class=n>d</span><span class=p>]</span> <span class=o>^=</span> <span class=n>x</span><span class=p>[</span><span class=n>a</span><span class=p>]</span>
    <span class=n>x</span><span class=p>[</span><span class=n>d</span><span class=p>]</span> <span class=o>=</span> <span class=n>rotate</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>d</span><span class=p>],</span> <span class=mi>8</span><span class=p>)</span>

    <span class=n>x</span><span class=p>[</span><span class=n>c</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>c</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=n>d</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xffffffff</span>
    <span class=n>x</span><span class=p>[</span><span class=n>b</span><span class=p>]</span> <span class=o>^=</span> <span class=n>x</span><span class=p>[</span><span class=n>c</span><span class=p>]</span>
    <span class=n>x</span><span class=p>[</span><span class=n>b</span><span class=p>]</span> <span class=o>=</span> <span class=n>rotate</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>b</span><span class=p>],</span> <span class=mi>7</span><span class=p>)</span>

<span class=k>def</span> <span class=nf>chacha20_block</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>counter</span><span class=p>,</span> <span class=n>nonce</span><span class=p>,</span> <span class=n>sigma</span><span class=p>):</span>
    <span class=n>state</span> <span class=o>=</span> <span class=p>(</span>
        <span class=nb>list</span><span class=p>(</span><span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s1>&#39;&lt;4I&#39;</span><span class=p>,</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>+</span>
        <span class=nb>list</span><span class=p>(</span><span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s1>&#39;&lt;8I&#39;</span><span class=p>,</span> <span class=n>key</span><span class=p>))</span> <span class=o>+</span>
        <span class=p>[</span><span class=n>counter</span><span class=p>]</span> <span class=o>+</span>
        <span class=nb>list</span><span class=p>(</span><span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s1>&#39;&lt;3I&#39;</span><span class=p>,</span> <span class=n>nonce</span><span class=p>))</span>
    <span class=p>)</span>

    <span class=n>working_state</span> <span class=o>=</span> <span class=n>state</span><span class=p>[:]</span>
    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>  <span class=c1># 20 rounds (10 double rounds)</span>
        <span class=n>quarter_round</span><span class=p>(</span><span class=n>working_state</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>12</span><span class=p>)</span>
        <span class=n>quarter_round</span><span class=p>(</span><span class=n>working_state</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>13</span><span class=p>)</span>
        <span class=n>quarter_round</span><span class=p>(</span><span class=n>working_state</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>14</span><span class=p>)</span>
        <span class=n>quarter_round</span><span class=p>(</span><span class=n>working_state</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>15</span><span class=p>)</span>
        <span class=n>quarter_round</span><span class=p>(</span><span class=n>working_state</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>15</span><span class=p>)</span>
        <span class=n>quarter_round</span><span class=p>(</span><span class=n>working_state</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>)</span>
        <span class=n>quarter_round</span><span class=p>(</span><span class=n>working_state</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>13</span><span class=p>)</span>
        <span class=n>quarter_round</span><span class=p>(</span><span class=n>working_state</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>14</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>):</span>
        <span class=n>working_state</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>working_state</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>state</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xffffffff</span>

    <span class=k>return</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;16I&#39;</span><span class=p>,</span> <span class=o>*</span><span class=n>working_state</span><span class=p>)</span>

<span class=k>def</span> <span class=nf>chacha20_decrypt</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>nonce</span><span class=p>,</span> <span class=n>ciphertext</span><span class=p>,</span> <span class=n>counter</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=sa>b</span><span class=s2>&#34;expand 32-byte K&#34;</span><span class=p>):</span>
    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=o>==</span> <span class=mi>32</span>
    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>nonce</span><span class=p>)</span> <span class=o>==</span> <span class=mi>12</span>
    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>sigma</span><span class=p>)</span> <span class=o>==</span> <span class=mi>16</span>

    <span class=n>plaintext</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
    <span class=k>for</span> <span class=n>block_index</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>),</span> <span class=mi>64</span><span class=p>):</span>
        <span class=n>block</span> <span class=o>=</span> <span class=n>chacha20_block</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>counter</span><span class=p>,</span> <span class=n>nonce</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)</span>
        <span class=n>chunk</span> <span class=o>=</span> <span class=n>ciphertext</span><span class=p>[</span><span class=n>block_index</span><span class=p>:</span><span class=n>block_index</span> <span class=o>+</span> <span class=mi>64</span><span class=p>]</span>
        <span class=n>keystream</span> <span class=o>=</span> <span class=n>block</span><span class=p>[:</span><span class=nb>len</span><span class=p>(</span><span class=n>chunk</span><span class=p>)]</span>
        <span class=n>plaintext</span> <span class=o>+=</span> <span class=nb>bytes</span><span class=p>([</span><span class=n>c</span> <span class=o>^</span> <span class=n>k</span> <span class=k>for</span> <span class=n>c</span><span class=p>,</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>chunk</span><span class=p>,</span> <span class=n>keystream</span><span class=p>)])</span>
        <span class=n>counter</span> <span class=o>+=</span> <span class=mi>1</span>
    <span class=k>return</span> <span class=n>plaintext</span>


<span class=n>key</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x8D\xEC\x91\x12\xEB\x76\x0E\xDA\x7C\x7D\x87\xA4\x43\x27\x1C\x35\xD9\xE0\xCB\x87\x89\x93\xB4\xD9\x04\xAE\xF9\x34\xFA\x21\x66\xD7</span><span class=s2>&#34;</span>
<span class=n>nonce</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x11\x11\x11\x11\x11\x11\x11\x11\x11\x11\x11\x11</span><span class=s2>&#34;</span>
<span class=n>encrypted_data</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xA9\xF6\x34\x08\x42\x2A\x9E\x1C\x0C\x03\xA8\x08\x94\x70\xBB\x8D\xAA\xDC\x6D\x7B\x24\xFF\x7F\x24\x7C\xDA\x83\x9E\x92\xF7\x07\x1D\x02\x63\x90\x2E\xC1\x58</span><span class=s2>&#34;</span>
<span class=n>custom_sigma</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;expand 32-byte K&#34;</span>

<span class=n>plaintext</span> <span class=o>=</span> <span class=n>chacha20_decrypt</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>nonce</span><span class=p>,</span> <span class=n>encrypted_data</span><span class=p>,</span> <span class=n>counter</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=n>custom_sigma</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Decrypted:&#34;</span><span class=p>,</span> <span class=n>plaintext</span><span class=p>)</span>
<span class=c1># Decrypted: b&#39;supp1y_cha1n_sund4y@flare-on.com\n\x86Xm\xb4U&#39;</span>
</code></pre></td></tr></table>
</div>
</div></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2024-12-31</span>
</div></div>
<div class=post-info-line>
<div class=post-info-md><span>
<a class=link-to-markdown href=/2024-flareon/index.md target=_blank>Read Markdown</a>
</span></div>
<div class=post-info-share>
<span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://ducdatdau.github.io/2024-flareon/ data-title="Flare-On 11" data-hashtags=Reverse-Engineering,Flare-On,2024><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://ducdatdau.github.io/2024-flareon/ data-hashtag=Reverse-Engineering><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://ducdatdau.github.io/2024-flareon/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags><a class="tag-badge tag-reverse" href=/tags/reverse-engineering/ title=Reverse-Engineering><span class=tag-icon aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1 h-4 w-4"><path d="M19.439 7.85c-.049.322.059.648.289.878l1.568 1.568c.47.47.706 1.087.706 1.704s-.235 1.233-.706 1.704l-1.611 1.611a.98.98.0 01-.837.276c-.47-.07-.802-.48-.968-.925a2.501 2.501.0 10-3.214 3.214c.446.166.855.497.925.968a.979.979.0 01-.276.837l-1.61 1.61A2.404 2.404.0 0112 22.002a2.402 2.402.0 01-1.704-.706l-1.568-1.568a1.026 1.026.0 00-.877-.29c-.493.074-.84.504-1.02.968a2.5 2.5.0 11-3.237-3.237c.464-.18.894-.527.967-1.02a1.026 1.026.0 00-.289-.877l-1.568-1.568A2.402 2.402.0 011.998 12c0-.617.236-1.234.706-1.704L4.23 8.77c.24-.24.581-.353.917-.303.515.077.877.528 1.073 1.01a2.5 2.5.0 103.259-3.259c-.482-.196-.933-.558-1.01-1.073-.05-.336.062-.676.303-.917l1.525-1.525A2.402 2.402.0 0112 1.998c.617.0 1.234.236 1.704.706l1.568 1.568c.23.23.556.338.877.29.493-.074.84-.504 1.02-.968a2.5 2.5.0 113.237 3.237c-.464.18-.894.527-.967 1.02z"/></svg></span><span class=tag-text>Reverse-Engineering</span></a>
<a class="tag-badge tag-flareon" href=/tags/flare-on/ title=Flare-On><span class=tag-icon aria-hidden=true>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13,2 3,14 12,14 11,22 21,10 12,10"/></svg></span><span class=tag-text>Flare-On</span></a>
<a class="tag-badge tag-default tag-year" href=/tags/2024/ title=2024><span class=tag-text>2024</span></a>
</section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section>
</div>
<div class=post-nav><a href=/2024-isitdtu-quals/ class=prev rel=prev title="ISITDTU Quals 2024"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>ISITDTU Quals 2024</a>
<a href=/2025-sekai/ class=next rel=next title="SEKAI CTF 2025">SEKAI CTF 2025<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div>
</div>
</article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2024 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://ducdatdau.github.io/ target=_blank>ducdatdau</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw" aria-hidden=true></i>
</a>
</div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body>
</html>