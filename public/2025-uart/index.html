<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<title>UART protocol - ducdatdau</title><meta name=Description content="just a street kid with a solid academic background"><meta property="og:title" content="UART protocol">
<meta property="og:description" content="img { box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px; border-radius: 6px; display: block; margin: 0 auto 15px; }  0x00. Overview Một số thiết bị nhúng có sẵn serial console để phục vụ việc khởi động, giám sát, và gỡ lỗi. Nếu có thể kết nối được với console thông qua UART, chúng ta hoàn toàn có thể truy cập vào shell và thực hiện một số việc như:">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ducdatdau.github.io/2025-uart/"><meta property="og:image" content="https://ducdatdau.github.io/logo.png"><meta property="article:section" content="research">
<meta property="article:published_time" content="2024-08-24T00:00:00+00:00">
<meta property="article:modified_time" content="2024-08-24T00:00:00+00:00"><meta property="og:site_name" content="ducdatdau blog">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://ducdatdau.github.io/logo.png">
<meta name=twitter:title content="UART protocol">
<meta name=twitter:description content="img { box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px; border-radius: 6px; display: block; margin: 0 auto 15px; }  0x00. Overview Một số thiết bị nhúng có sẵn serial console để phục vụ việc khởi động, giám sát, và gỡ lỗi. Nếu có thể kết nối được với console thông qua UART, chúng ta hoàn toàn có thể truy cập vào shell và thực hiện một số việc như:">
<meta name=application-name content="Blogs">
<meta name=apple-mobile-web-app-title content="Blogs"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://github.com/ducdatdau.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://ducdatdau.github.io/2025-uart/><link rel=next href=https://ducdatdau.github.io/2025-heap_ctf_theory/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"UART protocol","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ducdatdau.github.io\/2025-uart\/"},"genre":"posts","keywords":"IOT","wordcount":558,"url":"https:\/\/ducdatdau.github.io\/2025-uart\/","datePublished":"2024-08-24T00:00:00+00:00","dateModified":"2024-08-24T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"ducdatdau"},"description":""}</script></head>
<body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=ducdatdau>Home</a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/misc-notes/ title="Misc Notes"> Misc Notes </a><a class=menu-item href=/research/ title=Research> Security Research </a><a class=menu-item href=/ctf-writeup/ title="CTF Writeup"> CTF </a><a class=menu-item href=/list100/ title="List 100"> List 100 </a><a class=menu-item href=/tags/> Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search>
<i class="fas fa-search fa-fw" aria-hidden=true></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear>
<i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a></div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=ducdatdau>Home</a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search>
<i class="fas fa-search fa-fw" aria-hidden=true></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear>
<i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span>
</div>
<a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
Cancel
</a>
</div><a class=menu-item href=/misc-notes/ title="Misc Notes">Misc Notes</a><a class=menu-item href=/research/ title=Research>Security Research</a><a class=menu-item href=/ctf-writeup/ title="CTF Writeup">CTF</a><a class=menu-item href=/list100/ title="List 100">List 100</a><a class=menu-item href=/tags/ title>Tags</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a></div>
</div>
</header><div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div><main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2>
<div class=toc-content id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">UART protocol</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=https://ducdatdau.github.io/ title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>ducdatdau</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-08-24>2024-08-24</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;558 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;3 minutes&nbsp;</div><div class=post-meta-line>
<span class=post-tags-inline style="display:inline-flex;gap:.375rem;flex-wrap:wrap;margin:.5rem 0;font-weight:500"><a class="tag-badge tag-default" href=/tags/iot/ title=IOT><span class=tag-icon aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1 h-4 w-4"><polyline points="4 17 10 11 4 5"/><line x1="12" x2="20" y1="19" y2="19"/></svg>
</span><span class=tag-text>IOT</span></a>
</span>
</div></div><div class="details toc" id=toc-static data-kept>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#0x00-overview>0x00. Overview</a></li>
<li><a href=#0x01-uart-protocol>0x01 UART protocol</a></li>
<li><a href=#0x02-uart-frame>0x02 UART frame</a></li>
<li><a href=#0x03-uart-transmission>0x03 UART transmission</a></li>
<li><a href=#0x04-baud-rates>0x04 Baud Rates</a></li>
</ul>
</nav></div>
</div><div class=content id=content><style>img{box-shadow:rgba(0,0,0,.35)0 5px 15px;border-radius:6px;display:block;margin:0 auto 15px}</style>
<h2 id=0x00-overview>0x00. Overview</h2>
<p>Một số thiết bị nhúng có sẵn <em>serial console</em> để phục vụ việc khởi động, giám sát, và gỡ lỗi. Nếu có thể kết nối được với console thông qua UART, chúng ta hoàn toàn có thể truy cập vào shell và thực hiện một số việc như:</p>
<ul>
<li>Cài backdoor trên thiết bị.</li>
<li>Dịch ngược firmware để tìm lỗ hổng.</li>
</ul>
<h2 id=0x01-uart-protocol>0x01 UART protocol</h2>
<p>UART là viết tắt của <strong>Universal Asynchronous Receiver / Transmitter</strong>. Dịch nôm na là giao thức truyền nhận bất đồng bộ. UART interface có 4 chân cơ bản, đó là: <code>RX</code>, <code>TX</code>, <code>VCC</code>, <code>GND</code>. Trong đó có 3 chân thường thấy là <code>RX</code>, <code>TX</code> và <code>GND</code> có công dụng như sau:</p>
<ul>
<li><code>TX</code>: viết tắt của <strong>Transmitter</strong> là chân truyền dữ liệu</li>
<li><code>RX</code>: viết tắt của <strong>Receiver</strong> là chân nhận dữ liệu</li>
<li><code>GND</code>: viết tắt của <strong>Ground reference</strong> hay còn gọi là <strong>tham chiếu &ldquo;đất&rdquo;</strong>, dùng làm điểm để tham chiếu cho giá trị 0V và khử các tín hiệu nhiễu</li>
</ul>
<img src=./imgs/0.png>
<p>Để xác định được chính xác các chân, ta có thể sử dụng các công cụ như đồng hồ vạn năng hay Logic Anayzer.</p>
<img src=./imgs/1.png>
<p>Tham khảo thêm cách sử dụng các thiết bị trên ở đây:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=01mw0oTHwxg" target=_blank rel="noopener noreffer">Hacker&rsquo;s Guide to UART Root Shells</a></li>
<li><a href=https://riverloopsecurity.com/blog/2020/01/hw-101-uart/ target=_blank rel="noopener noreffer">Hardware Hacking 101: Getting a root shell via UART</a></li>
</ul>
<hr>
<p>Trường hợp 1. Sử dụng đồng hồ vạn năng</p>
<ul>
<li>Nếu có tiếng kêu → Đó là chân GND</li>
<li>Nếu điện áp là 0V → Đó là chân RX vì nó đợi dữ liệu</li>
<li>Nếu điện áp thay đôi → Đó là chân TX vì nó đang gửi dữ liệu</li>
</ul>
<p>Trường hợp 2. Sử dụng Logic Anayzer</p>
<img src=./imgs/2.jpg width=400px/>
<p>Công cụ chúng ta sử dụng để bắt các tín hiệu là Saleae Logic Anayzer. Phần mềm để phân tích các tín hiệu là Logic 2. Để tiến hành phân tích, ta sẽ lần lượt thực hiện các bước sau:</p>
<ol>
<li>Chọn Analyzers</li>
<li>Chọn Async Serial</li>
<li>Thiết lập các giá trị phù hợp cho Bit Rate, Stop Bits, Parity Bit. Những giá trị còn lại thường sẽ để standard.</li>
</ol>
<p>Lấy ví dụ minh họa là kết quả bài ctf hardware/An4lyz3_1t ở giải ACSC 2024</p>
<img src=./imgs/12.png>
<h2 id=0x02-uart-frame>0x02 UART frame</h2>
<img src=./imgs/3.png>
<p>Để truyền dữ liệu đi, dữ liệu sẽ được đóng gói thành các packet. Cấu trúc của packet như trên ảnh:</p>
<ul>
<li>Bit khởi đầu: 1 bit</li>
<li>Bit dữ liệu: 5 → 8 bits</li>
<li>Bit chẵn lẻ: 1 bit</li>
<li>Bit kết thúc: 1 → 2 bits</li>
</ul>
<p>Dưới đây là hình ảnh của frame khi truyền chữ cái A (0x41)</p>
<img src=./imgs/4.png>
<h2 id=0x03-uart-transmission>0x03 UART transmission</h2>
<img src=./imgs/5.png>
<p>Step 1. Transmitting UART nhận dữ liệu song song từ các bus dữ liệu</p>
<img src=./imgs/6.png width=500px/>
<p>Step 2. Đóng gói packet, thêm các bit như start bit, parity, stop bit</p>
<img src=./imgs/7.png width=400px/>
<p>Step 3. Truyền dữ liệu</p>
<img src=./imgs/8.png width=600px/>
<p>Step 4. Receiving UART unpack, lấy dữ liệu trong data frame</p>
<img src=./imgs/9.png width=400px/>
<p>Step 5. Receiving UART truyền song song các dữ liệu vào các bus dữ liệu</p>
<img src=./imgs/10.png width=500px/>
<h2 id=0x04-baud-rates>0x04 Baud Rates</h2>
<p>Tốc độ truyền dữ liệu cho biết dữ liệu đã được truyền qua dây nhanh như nào. Đồng thời, tốc độ truyền và nhận dữ liệu phải bằng nhau.</p>
<p>Một số tốc độ phổ biến là:</p>
<ul>
<li>9600 (bps) trên thiết bị cũ</li>
<li>115200 (bps) trên thiết bị hiện đại</li>
</ul>
<p>Công thức tính bps = 1 / bit width</p>
<img src=./imgs/11.png></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2024-08-24</span>
</div></div>
<div class=post-info-line>
<div class=post-info-md><span>
<a class=link-to-markdown href=/2025-uart/index.md target=_blank>Read Markdown</a>
</span></div>
<div class=post-info-share>
<span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://ducdatdau.github.io/2025-uart/ data-title="UART protocol" data-hashtags=IOT><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://ducdatdau.github.io/2025-uart/ data-hashtag=IOT><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://ducdatdau.github.io/2025-uart/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags><a class="tag-badge tag-default" href=/tags/iot/ title=IOT><span class=tag-icon aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1 h-4 w-4"><polyline points="4 17 10 11 4 5"/><line x1="12" x2="20" y1="19" y2="19"/></svg>
</span><span class=tag-text>IOT</span></a>
</section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section>
</div>
<div class=post-nav>
<a href=/2025-heap_ctf_theory/ class=next rel=next title="Heap CTF Theory">Heap CTF Theory<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div>
</div>
</article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2024 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://ducdatdau.github.io/ target=_blank>ducdatdau</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw" aria-hidden=true></i>
</a>
</div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body>
</html>